<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>HPSP131 - Workbook 9 - Path Analysis and Structural Equation Modelling</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">HPSP131</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="1intro.html">1. Intro</a>
</li>
<li>
  <a href="2data.html">2. Data 1</a>
</li>
<li>
  <a href="7GLM.html">3. Data 2</a>
</li>
<li>
  <a href="3plot.html">4. Plot</a>
</li>
<li>
  <a href="4LM1.html">5. LM1</a>
</li>
<li>
  <a href="5LM2.html">6. LM2</a>
</li>
<li>
  <a href="6mod_med.html">7. Mod Med</a>
</li>
<li>
  <a href="8sim.html">8. Sim</a>
</li>
<li>
  <a href="9SEM.html">9. SEM</a>
</li>
<li>
  <a href="10mixed.html">10. Mixed</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="exercises.html">Exercises</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">HPSP131 - Workbook 9 - Path Analysis and Structural Equation Modelling</h1>

</div>


<div id="objectives" class="section level1">
<h1>Objectives</h1>
<p>The aim of this week is to introduce the <code>lavaan</code> package for Structural Equation Modelling (e.g., path analysis) in R. By the end of this workbook, you should be familiar with:</p>
<ol style="list-style-type: decimal">
<li>The basics of the lavaan package.</li>
<li>Run a simple path analysis.</li>
</ol>
</div>
<div id="resources" class="section level1">
<h1>Resources</h1>
<p>Here is a list of resources that may help you with this weeks content:</p>
<p><a href="http://lavaan.ugent.be/tutorial/">lavaan tutorial</a></p>
<p><a href = "files/data_2019.csv" download>Click here to download the data used in these workbooks.</a> (You may need to right-click and select ‘Save Linked File’ option)</p>
</div>
<div id="exercises" class="section level1">
<h1>Exercises</h1>
<p><a href = "exercises.html">Click here to download this week’s exercises.</a></p>
</div>
<div id="content" class="section level1">
<h1>Content</h1>
<p>We will be using the following packages in this week’s workbook:</p>
<pre class="r"><code>library(lavaan)
library(tidyverse)
library(semPlot)</code></pre>
<div id="before-we-start" class="section level2">
<h2>Before We Start…</h2>
<p>This workbook is only meant to serve as an introduction to the <code>lavaan</code> package, and therefore will only introduce some of the basic functions. You are able to add a lot of complexity to structural equation models that we will not be touching. If you truely wish to master this package, you will need to go beyond the content covered here.</p>
</div>
<div id="mediation-analysis-through-structural-equation-modelling-sem" class="section level2">
<h2>Mediation Analysis Through Structural Equation Modelling (SEM)</h2>
<p>Mediation is an example of a simple SEM. We will first re-run the mediation we conducted in Workbook 7 in the <code>lavaan</code> package. If you recall, we were interested in the relationship between statistics teacher comprehension and stress and whether this is explained through individual’s belief about the anxiety at taking statistics test (i.e., individuals who find statistics teachers hard to understand increase their anxiety about taking statistics tests, which in turn increases stress).</p>
<p>As with all analyses, we will be following the basic procedure of:</p>
<ol style="list-style-type: decimal">
<li>Clean the data for analysis.</li>
<li>Run the statistical test.</li>
<li>Plot the data.</li>
<li>Write-up analysis.</li>
</ol>
<div id="clean-the-data-for-analysis." class="section level3">
<h3>1. Clean the data for analysis.</h3>
<p>As always, our first step is to calculate the variables from the individual items.</p>
<p>The code below is identical to the code that we ran in Workbook 7 to prepare the data for analysis.</p>
<pre class="r"><code>data2.clean &lt;- data %&gt;%
  mutate(teacher = stars.30 + stars.32 + stars.43 + stars.44 + stars.46,
         support = support.1 + support.2 + support.3 + support.4 + support.5 + support.6 + support.7 + support.8 + support.9 + support.10 + support.11 + support.12,
         stress = stress.1 + stress.2 + stress.3 + stress.4 + stress.5 + stress.6 + stress.7 + stress.8 + stress.9 + stress.10,
         stars.test = stars.1 + stars.4 + stars.8 + stars.10 + stars.13 + stars.15 + stars.21 + stars.22) %&gt;%
  dplyr::select(student.no,teacher,support,stars.test,stress)</code></pre>
</div>
<div id="run-statistical-test." class="section level3">
<h3>2. Run statistical test.</h3>
<p>Previously, when specifying a regression in R, we have used the following form:</p>
<blockquote>
<p>y ~ x1 + x2 + x3 + …</p>
</blockquote>
<p>An SEM formula is an extention of of this, where multiple regression equations (or similar relationships) are estimated at once. Like with a regression, we use the <code>~</code> to specify a relationship between an outcome (on the left), and predictors (on the right).</p>
<p>In the table below are some other relationships that you may use when constructing a SEM.</p>
<table style="width:100%;">
<colgroup>
<col width="9%" />
<col width="18%" />
<col width="20%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>operator</th>
<th>relationship type</th>
<th>example</th>
<th>explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>=~</code></td>
<td>Latent Variable</td>
<td>y =~ x1 + x2 + x3…</td>
<td>y is measured by x1, x2, x3, etc.</td>
</tr>
<tr class="even">
<td><code>~~</code></td>
<td>Covariance</td>
<td>x1 ~~ x2</td>
<td>x1 is correlated with x2</td>
</tr>
<tr class="odd">
<td><code>:=</code></td>
<td>Define Parameter</td>
<td>effect := a*b</td>
<td>Estimate ‘effect’ which is made up of ‘a’ times ‘b’</td>
</tr>
</tbody>
</table>
<p>Note: you can also label parameters by using the <code>*</code> symbol before variables. If you give two variables the same label, it will force the estimates to be the same (this comes in handy sometimes, but not something we will use in this workbook).</p>
<p>Below is the formula to conduct a mediation analysis identical to the one we conducted in Workbook 7. See if you can understand each line and what relationship it is specifying before reading the breakdown:</p>
<pre class="r"><code>sem.formula &lt;- &#39;
stress ~ c*teacher
stress ~ b*stars.test
stars.test ~ a*teacher

indirect := a*b
direct := c
total := direct + indirect
&#39;</code></pre>
<p>Let’s break this down:</p>
<table>
<colgroup>
<col width="26%" />
<col width="73%" />
</colgroup>
<thead>
<tr class="header">
<th>line</th>
<th>explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>stress ~ c*teacher</td>
<td>Stress is predicted from teacher, and this relationship is labelled ‘c’</td>
</tr>
<tr class="even">
<td>stress ~ b*statsanxiety</td>
<td>Stress is predicted from statsanxiety, and this relationship is labelled ‘b’</td>
</tr>
<tr class="odd">
<td>statsanxiety ~ a*teacher</td>
<td>Statsanxiety is predicted from teacher, and this relationship is labelled ‘a’</td>
</tr>
<tr class="even">
<td>indirect := a*b</td>
<td>Define a parameter called ‘indirect’ which is made up of ‘a’ times ‘b’</td>
</tr>
<tr class="odd">
<td>direct := c</td>
<td>Define a parameter called ‘direct’ which is made up of ‘c’</td>
</tr>
<tr class="even">
<td>total := direct + indirect</td>
<td>Define the total effect (the combination of direct and indirect effect).</td>
</tr>
</tbody>
</table>
<p>Essentially, the first three lines of the code are identical to running the <code>y.model</code> and <code>m.model</code> that we ran in Workbook 7, while the last two lines are like running the <code>mediate()</code> function get estimate the indirect and direct effect.</p>
<p>To run the SEM, we use the <code>sem()</code> function. Like all analyses done previously, we need to specify two things: the formula (which we saved as the object <code>sem.formula</code>) and the dataset.</p>
<pre class="r"><code>med.sem.model &lt;- sem(sem.formula,data2.clean)

summary(med.sem.model)</code></pre>
<pre><code>## lavaan 0.6-3 ended normally after 19 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                          5
## 
##                                                   Used       Total
##   Number of observations                           114         118
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                       0.000
##   Degrees of freedom                                 0
##   Minimum Function Value               0.0000000000000
## 
## Parameter Estimates:
## 
##   Information                                 Expected
##   Information saturated (h1) model          Structured
##   Standard Errors                             Standard
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   stress ~                                            
##     teacher    (c)   -0.103    0.109   -0.947    0.344
##     stars.test (b)    0.008    0.043    0.181    0.856
##   stars.test ~                                        
##     teacher    (a)    0.631    0.229    2.759    0.006
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .stress            9.169    1.214    7.550    0.000
##    .stars.test       43.219    5.725    7.550    0.000
## 
## Defined Parameters:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     indirect          0.005    0.027    0.181    0.856
##     direct           -0.103    0.109   -0.947    0.344
##     total            -0.098    0.105   -0.931    0.352</code></pre>
<p>If we compare the results here to that of Workbook 7, we should see that we get the same results.</p>
</div>
<div id="plot-the-model." class="section level3">
<h3>3. Plot the model.</h3>
<p>The easiest way to plot a structural equation model is using a path diagram. Unfortunately, this is not easy to do in <code>ggplot2</code>. However, we can use a the <code>semPaths()</code> function from the <code>semPlot</code> package. This function has the advantage of being easy to use - all you need to do is load your model estimated in laavan and specify which paths you want to see (or hide). The disadvantage is that you cannot choose how you layout your path diagram, or customise the look of your diagram. Therefore, in order to create publication worthy graphics, you must use another program.</p>
<pre class="r"><code>semPaths(med.sem.model,whatLabel = &quot;est&quot;,intercept = FALSE,residuals = FALSE)</code></pre>
<p><img src="9SEM_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
</div>
<div id="more-complicated-path-analysis" class="section level2">
<h2>More complicated Path Analysis</h2>
<p>We will now have a go at conducting a more complicated SEM. We will revisit the data from Workbook 5 to determine the relationship between attitudes to fitness, norms surrounding fitness, perceived behavioural control, and intentions to exercise, on exercise behaviour. The model we will fit is based on the Theory of Planned Behaviour, and is depicted below.</p>
<div class="figure">
<img src="images/TPB.png" />

</div>
<p>In words, we predict that attitudes towards exercise, norms about exercise, and perceived behavioural control regarding exercise will predict intention to exercise. In turn, intention to exercise predict exercise behaviour. We also predict that perceived behavioural control regarding exercise will directly predict exercise behaviour.</p>
<div id="clean-the-data-for-analysis.-1" class="section level3">
<h3>1. Clean the data for analysis.</h3>
<p>First, we must calculate the variables from each of the items.</p>
<pre class="r"><code>data2.clean &lt;- data %&gt;%
  mutate(attitude = exercise.attitude.1 + exercise.attitude.2 + exercise.attitude.3 + exercise.attitude.4 + exercise.attitude.5 + exercise.attitude.6 + exercise.attitude.7 + exercise.attitude.8 + exercise.attitude.9 + exercise.attitude.10 + exercise.attitude.11 + exercise.attitude.12 + exercise.attitude.13 + exercise.attitude.14 + exercise.attitude.15 + exercise.attitude.16 + exercise.attitude.17 + exercise.attitude.18 + exercise.attitude.19,
         intention = exercise.intention.1 + exercise.intention.2 + exercise.intention.3 + exercise.intention.4 + exercise.intention.5 + exercise.intention.6 + exercise.intention.7 + exercise.intention.8 + exercise.intention.9 + exercise.intention.10 + exercise.intention.11,
         control = exercise.control.1 + exercise.control.2 + exercise.control.3,
         norms = exercise.norms.1 + exercise.norms.2 + exercise.norms.3 + exercise.norms.4 + exercise.norms.5 + exercise.norms.6,
         behaviour = exercise.behaviour.1 + exercise.behaviour.2 + exercise.behaviour.3 + exercise.behaviour.4 + exercise.behaviour.5 + exercise.behaviour.6 + exercise.behaviour.7 + exercise.behaviour.8 + exercise.behaviour.9 + exercise.behaviour.10 + exercise.behaviour.11) %&gt;%
  dplyr::select(student.no,attitude,intention,control,norms,behaviour)</code></pre>
</div>
<div id="run-statistical-test.-1" class="section level3">
<h3>2. Run statistical test.</h3>
<p>First, we need to specify the model. Below, this model is specified as formula that <code>lavaan</code> can read:</p>
<pre class="r"><code>model &lt;- &#39;
intention ~ attitude + norms + control
behaviour ~ intention + control
&#39;</code></pre>
<p>To break down the code above: Line 1: Attitudes, norms, and control predict intention. Line 2: Intention and control predicts behaviour.</p>
<p>We then run the SEM model using the <code>sem()</code> function:</p>
<pre class="r"><code>sem.model &lt;- sem(model,data = data2.clean)
summary(sem.model,standardized = TRUE,fit = TRUE, rsquare = TRUE)</code></pre>
<pre><code>## lavaan 0.6-3 ended normally after 20 iterations
## 
##   Optimization method                           NLMINB
##   Number of free parameters                          7
## 
##                                                   Used       Total
##   Number of observations                           106         118
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                      23.981
##   Degrees of freedom                                 2
##   P-value (Chi-square)                           0.000
## 
## Model test baseline model:
## 
##   Minimum Function Test Statistic              150.999
##   Degrees of freedom                                 7
##   P-value                                        0.000
## 
## User model versus baseline model:
## 
##   Comparative Fit Index (CFI)                    0.847
##   Tucker-Lewis Index (TLI)                       0.466
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)               -768.240
##   Loglikelihood unrestricted model (H1)       -756.250
## 
##   Number of free parameters                          7
##   Akaike (AIC)                                1550.480
##   Bayesian (BIC)                              1569.124
##   Sample-size adjusted Bayesian (BIC)         1547.009
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.322
##   90 Percent Confidence Interval          0.215  0.443
##   P-value RMSEA &lt;= 0.05                          0.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.060
## 
## Parameter Estimates:
## 
##   Information                                 Expected
##   Information saturated (h1) model          Structured
##   Standard Errors                             Standard
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   intention ~                                                           
##     attitude          0.304    0.057    5.319    0.000    0.304    0.508
##     norms             0.238    0.119    1.991    0.047    0.238    0.154
##     control           0.499    0.285    1.752    0.080    0.499    0.155
##   behaviour ~                                                           
##     intention         0.380    0.099    3.834    0.000    0.380    0.328
##     control           1.553    0.319    4.869    0.000    1.553    0.417
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .intention        67.104    9.217    7.280    0.000   67.104    0.519
##    .behaviour       100.796   13.845    7.280    0.000  100.796    0.581
## 
## R-Square:
##                    Estimate
##     intention         0.481
##     behaviour         0.419</code></pre>
<p>Notice above in the <code>summary()</code> function, we have included additional arguments to get extra statistics that are helpful when it comes to report the analysis.</p>
</div>
<div id="plot-the-model.-1" class="section level3">
<h3>3. Plot the model.</h3>
<p>Again, we use <code>semPaths()</code> to plot our SEM model. Here, the limitations of not being able to organise the layout of your plot is apparant, though it still may be helpful to visualise your results to help your understanding.</p>
<pre class="r"><code>semPaths(sem.model,whatLabel = &quot;est&quot;,intercept = FALSE,residuals = FALSE)</code></pre>
<p><img src="9SEM_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
</div>
<div id="introducing-latent-variables" class="section level2">
<h2>Introducing Latent Variables</h2>
<p>Up to now, to calculate variables from individual items, we have been adding each item up. However, we could also compute latent variables, which are the underlying variables that each item is meant to tap into.</p>
<p>For example, we could calculate the latent variable ‘attitude’ from each of the individual items.</p>
<pre class="r"><code>attitude.formula &lt;- &#39;
  attitude =~ exercise.attitude.1 + exercise.attitude.2 + exercise.attitude.3 + exercise.attitude.4 + exercise.attitude.5 + exercise.attitude.6 + exercise.attitude.7 + exercise.attitude.8 + exercise.attitude.9 + exercise.attitude.10 + exercise.attitude.11 + exercise.attitude.12 + exercise.attitude.13 + exercise.attitude.14 + exercise.attitude.15 + exercise.attitude.16 + exercise.attitude.17 + exercise.attitude.18 + exercise.attitude.19
&#39;

attitude.model &lt;- sem(attitude.formula,data = data)
semPaths(attitude.model,whatLabel = &quot;est&quot;,intercept = FALSE,residuals = FALSE)</code></pre>
<p><img src="9SEM_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>How about we compute latent variables for all the variables in the TPB model above? Doing something like this may not make a lot of sense: we will end up with a gangly model, and we may not have enough observations to get sensible results, but let’s do it anyway! For demonstrative purposes…</p>
<div id="specify-the-model" class="section level3">
<h3>Specify the Model</h3>
<pre class="r"><code>model &lt;- &#39;
  attitude =~ exercise.attitude.1 + exercise.attitude.2 + exercise.attitude.3 + exercise.attitude.4 + exercise.attitude.5 + exercise.attitude.6 + exercise.attitude.7 + exercise.attitude.8 + exercise.attitude.9 + exercise.attitude.10 + exercise.attitude.11 + exercise.attitude.12 + exercise.attitude.13 + exercise.attitude.14 + exercise.attitude.15 + exercise.attitude.16 + exercise.attitude.17 + exercise.attitude.18 + exercise.attitude.19
  intention =~ exercise.intention.1 + exercise.intention.2 + exercise.intention.3 + exercise.intention.4 + exercise.intention.5 + exercise.intention.6 + exercise.intention.7 + exercise.intention.8 + exercise.intention.9 + exercise.intention.10 + exercise.intention.11
  control =~ exercise.control.1 + exercise.control.2 + exercise.control.3
  norms =~ exercise.norms.1 + exercise.norms.2 + exercise.norms.3 + exercise.norms.4 + exercise.norms.5 + exercise.norms.6
  behaviour =~ exercise.behaviour.1 + exercise.behaviour.2 + exercise.behaviour.3 + exercise.behaviour.4 + exercise.behaviour.5 + exercise.behaviour.6 + exercise.behaviour.7 + exercise.behaviour.8 + exercise.behaviour.9 + exercise.behaviour.10 + exercise.behaviour.11

  intention ~ attitude + norms + control
  behaviour ~ intention + control
&#39;</code></pre>
<p>We won’t run the <code>summary()</code> just now because it is very unwieldy…</p>
<pre class="r"><code>sem.model &lt;- sem(model,data = data)
#summary(sem.model,standardized = TRUE,fit = TRUE, rsquare = TRUE)</code></pre>
<p>Again, we can plot the SEM using <code>semPaths()</code>, but this gets pretty messy, given the number of items make up each latent variable.</p>
</div>
</div>
</div>
<div id="plot-the-model" class="section level1">
<h1>Plot the Model</h1>
<pre class="r"><code>load(&quot;files/sem.model.Rdata&quot;)</code></pre>
<pre class="r"><code>#Note: Due to the size of the model, this line of code is causing errors when knitting together the website, and therefore is not run now.
semPaths(sem.model,whatLabel = &quot;est&quot;,intercept = FALSE,residuals = FALSE)</code></pre>
</div>
<div id="exercises-1" class="section level1">
<h1>Exercises</h1>
<p>Now that you’ve completed this week’s workbook, why not give this week’s exercises a go? You can download the interactive exercises by clicking the link below.</p>
<p><a href = "exercises.html">Click here to download this week’s exercises.</a></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
