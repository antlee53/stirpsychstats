---
title: "Exercise 3"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
library(tidyverse)
knitr::opts_chunk$set(echo = FALSE)

checker <- function(label,user_code,solution_code,check_code,envir_result,evaluate_result,envir_prep,...){
  
  envir_result
  out <- list(message = sample(c("Good Job!",
                                 "Well done!",
                                 "Great stuff!",
                                 "That is correct!",
                                 "Correct! You are really good at this."),1), correct = TRUE, location = "append")
  
#Question 1
if(label == "question_1"){
	if(!exists("countries")){
		out <- list(message = "No object saved as countries. Do not alter the object called `countries`.", correct = FALSE, location = "append")
    } else {
		if(!identical(countries,c("Scotland","England","France","Wales","Scotland","Australia","Scotland","England","United States","Iceland","Scotland","Spain","Scotland","Swaziland","Scotland","Switzerland","Scotland","England","France","Wales","Scotland","Australia","Scotland","England","United States","Iceland","Scotland","Spain","Scotland","Swaziland","Scotland","Switzerland"))){
			out <- list(message = "The object saved as `countries` appears to have been altered. Do not alter this object. Click the `Start Over` button if necessary.", correct = FALSE, location = "append")
		} else {
			if(!exists("Scotland_N")){
				out <- list(message = "No object saved as `Scotland_N`.", correct = FALSE, location = "append")
			} else {
				if(Scotland_N != 12){
					out <- list(message = "The number saved as `answer` is not correct. Check the submitted code for any errors.", correct = FALSE, location = "append")
				}
			}
		}
	}
}

#Question 2
if (label == "question_2"){
	if(!exists("numbers")){
		out <- list(message = "No object saved as numbers. Do not alter the object called `numbers`.", correct = FALSE, location = "append")
	} else {
		if(!identical(numbers,c(71,66,64,80,19,96,33,60,61,20,37,14,74,45,70,52,43,93,53,42,36,91,82,22,9,26,95,21,75,16,52,7,36,90,45,59,60,54,95,35,38,97,49,71,38,70,6,96,85,43,45,99,51,78,49,72,44,96,62,74,62,85,17,22,89,23,98,5,80,37,17,40,75,48,3,76,88,71,80,46,88,13,34,58,94,24,28,27,68,63,17,97,23,95,37,80,2,40,36,8))){
			out <- list(message = "The object saved as `numbers` appears to have been altered. Do not alter this object. Click the `Start Over` button if necessary.", correct = FALSE, location = "append")
		} else {
			if(!exists("less_than_53")){
				out <- list(message = "No object saved as `less_than_53`.", correct = FALSE, location = "append")
			} else {
				if(less_than_53 != 51){
					out <- list(message = "The number saved as `less_than_53` is not correct. Check the submitted code for any errors.", correct = FALSE, location = "append")
				}
			}
		}
	}
}

#Question 3
if(label == "question_3"){
	
	correct_numbers <- data.frame(ID = 1:100,
                      remove = c('Include','Exclude','Exclude','Exclude','Exclude','Exclude','Include','Include','Include','Include','Include','Include','Include','Include','Exclude','Include','Exclude','Exclude','Include','Include','Include','Include','Exclude','Include','Exclude','Exclude','Include','Include','Exclude','Exclude','Include','Include','Include','Exclude','Include','Include','Exclude','Include','Include','Exclude','Include','Exclude','Include','Include','Exclude','Exclude','Exclude','Exclude','Exclude','Include','Include','Include','Include','Exclude','Exclude','Exclude','Include','Include','Exclude','Exclude','Include','Exclude','Exclude','Include','Include','Include','Exclude','Include','Exclude','Include','Include','Include','Exclude','Include','Exclude','Include','Include','Exclude','Exclude','Include','Include','Include','Include','Include','Include','Exclude','Include','Include','Exclude','Include','Exclude','Exclude','Include','Include','Exclude','Exclude','Exclude','Exclude','Include','Exclude'),
                      var1 = c(71,66,64,80,19,96,33,60,61,20,37,14,74,45,70,52,43,93,53,42,36,91,82,22,9,26,95,21,75,16,52,7,36,90,45,59,60,54,95,35,38,97,49,71,38,70,6,96,85,43,45,99,51,78,49,72,44,96,62,74,62,85,17,22,89,23,98,5,80,37,17,40,75,48,3,76,88,71,80,46,88,13,34,58,94,24,28,27,68,63,17,97,23,95,37,80,2,40,36,8))
	
	if (!exists("numbers")){
		out <- list(message = "No object saved as numbers. Do not alter the object called `numbers`.", correct = FALSE, location = "append")
	} else {
		if(!identical(numbers,correct_numbers)){
			out <- list(message = "The object saved as `numbers` appears to have been altered. Do not alter this object. Click the `Start Over` button if necessary.", correct = FALSE, location = "append")
		} else {
			if(!exists("numbers_filtered")){
				out <- list(message = "There is no object named `numbers_filtered`.", correct = FALSE, location = "append")
			} else {
				if(!is.data.frame(numbers_filtered)){
					out <- list(message = "The object saved as `numbers_filtered` is not a data.frame.", correct = FALSE, location = "append")
				} else {
					if(!identical(numbers_filtered,filter(correct_numbers,remove != "Exclude"))){
					out <- list(message = "The data.frame saved as `numbers_filtered` does not match the correct answer. Please check the code for errors.", correct = FALSE, location = "append")
					}
				}
			}
		}
	}
}

#Question 4
if(label == "question_4"){
	
	correct_personality <- data.frame(ID = 1:6,
                      openness = c(3,5,1,4,2,3),
                      conscientiousness = c(1,4,2,3,3,2),
                      extraversion = c(3,5,4,2,2,3),
                      agreeableness = c(1,3,2,2,5,3),
                      neuroticism = c(3,3,4,2,1,5))
	
	if(!exists("personality")){
		out <- list(message = "No object saved as personality. Do not alter the object called `personality`.", correct = FALSE, location = "append")
	} else {
		if(!identical(personality,correct_personality)){
			out <- list(message = "The object saved as `personality` appears to have been altered. Do not alter this object. Click the `Start Over` button if necessary.", correct = FALSE, location = "append")
		} else {
			if(!exists("personality_cleaned")){
				out <- list(message = "There is no object named `personality_cleaned`.", correct = FALSE, location = "append")
			} else {
				if(!is.data.frame(personality_cleaned)){
					out <- list(message = "The object saved as `personality_cleaned` is not a data.frame.", correct = FALSE, location = "append")
				} else {
					if(!("conscientiousness" %in% colnames(personality_cleaned))){
						out <- list(message = "The data.frame saved as `personality_cleaned` does not include the conscientiousness variable." , correct = FALSE, location = "append")
					} else {
						if(!("neuroticism" %in% colnames(personality_cleaned))){
							out <- list(message = "The data.frame saved as `personality_cleaned` does not include the neuroticism variable." , correct = FALSE, location = "append")
						} else {
							if(!("ID" %in% colnames(personality_cleaned))){
								out <- list(message = "The data.frame saved as `personality_cleaned` does not include the ID variable." , correct = FALSE, location = "append")
							} else {
								if("openness" %in% colnames(personality_cleaned) | "extraversion" %in% colnames(personality_cleaned) | "agreeableness" %in% colnames(personality_cleaned)){
									out <- list(message = "The data.frame saved as `personality_cleaned` still contains variables that are not the ones specified above." , correct = FALSE, location = "append")
								} else {
									if(ncol(personality_cleaned) != 3){
										out <- list(message = "The data.frame saved as `personality_cleaned` does not match the correct answer. Check for errors in the code above." , correct = FALSE, location = "append")
									}								
								}
							}
						}
					}
				}
			}
		}
	}
}

if(label == "question_5"){
	
	correct_phys_exer <- data.frame(ID = 1:6,
                      sunday = c(0,15,10,40,0,30),
                      monday = c(10,40,20,30,0,20),
                      tuesday = c(30,15,40,20,0,30),
                      wednesday = c(10,30,20,20,0,30),
                      thursday = c(30,30,40,20,10,15),
                      friday = c(5,60,30,10,10,0),
                      saturday = c(120,0,10,20,10,0))
	
	if(!exists("phys_exer")){
		out <- list(message = "No object saved as phys_exer. Do not alter the object called `phys_exer`.", correct = FALSE, location = "append")
	} else {
		if(!identical(phys_exer,correct_phys_exer)){
			out <- list(message = "The object saved as `phys_exer` appears to have been altered. Do not alter this object. Click the `Start Over` button if necessary.", correct = FALSE, location = "append")
		} else {
			if(!exists("phys_exer_total")){
				out <- list(message = "There is no object named `phys_exer_total`.", correct = FALSE, location = "append")
			} else {
				if(!is.data.frame(phys_exer_total)){
					out <- list(message = "The object saved as `phys_exer_total` is not a data.frame.", correct = FALSE, location = "append")
				} else {
					if(!("total" %in% colnames(phys_exer_total))){
						out <- list(message = "There is no variable called 'total' in the data.frame `phys_exer_total`.", correct = FALSE, location = "append")
					} else {
						if(!identical(correct_phys_exer$sunday +
						              correct_phys_exer$monday +
						              correct_phys_exer$tuesday +
						              correct_phys_exer$wednesday +
						              correct_phys_exer$thursday +
						              correct_phys_exer$friday +
						              correct_phys_exer$saturday,phys_exer_total$total)){
							out <- list(message = "The variable 'total' in the data.frame `phys_exer_total` does not match the correct answer. Check there are no errors in the submitted code.", correct = FALSE, location = "append")
						}
					}
				}
			}
		}
	}
}  

if(label == "question_6"){
	
	correct_phys_exer <- data.frame(ID = 1:6,
                      sunday = c(0,15,10,40,0,30),
                      monday = c(10,40,20,30,0,20),
                      tuesday = c(30,15,40,20,0,30),
                      wednesday = c(10,30,20,20,0,30),
                      thursday = c(30,30,40,20,10,15),
                      friday = c(5,60,30,10,10,0),
                      saturday = c(120,0,10,20,10,0))
	
	if(!exists("phys_exer")){
		out <- list(message = "No object saved as phys_exer. Do not alter the object called `phys_exer`.", correct = FALSE, location = "append")
	} else {
		if(!identical(phys_exer,correct_phys_exer)){
			out <- list(message = "The object saved as `phys_exer` appears to have been altered. Do not alter this object. Click the `Start Over` button if necessary.", correct = FALSE, location = "append")
		} else {
			if(!exists("phys_exer_total")){
				out <- list(message = "There is no object named `phys_exer_total`.", correct = FALSE, location = "append")
			} else {
				if(!is.data.frame(phys_exer_total)){
					out <- list(message = "The object saved as `phys_exer_total` is not a data.frame.", correct = FALSE, location = "append")
				} else {
					if(!("total" %in% colnames(phys_exer_total))){
						out <- list(message = "There is no variable called 'total' in the data.frame `phys_exer_total`.", correct = FALSE, location = "append")
					} else {
						if(identical(correct_phys_exer$sunday +
						              correct_phys_exer$monday + 
						              correct_phys_exer$tuesday + 
						              correct_phys_exer$wednesday + 
						              correct_phys_exer$thursday + 
						              correct_phys_exer$friday +
						              correct_phys_exer$saturday,phys_exer_total$total)){
							out <- list(message = "The variable 'total' is still the total number of minutes across the week and not the mean number of minutes per day. Edit the code so that 'total' is the mean number of minutes.", correct = FALSE, location = "append")
						} else {
							if(!identical((correct_phys_exer$sunday + correct_phys_exer$monday + correct_phys_exer$tuesday + correct_phys_exer$wednesday + correct_phys_exer$thursday + correct_phys_exer$friday + correct_phys_exer$saturday)/7,phys_exer_total$total)){
							out <- list(message = "The variable 'total' in the data.frame `phys_exer_total` does not match the correct answer. Check there are no errors in the submitted code.", correct = FALSE, location = "append")
							}
						}
					}
				}
			}
		}
	}
}
  
if(label == "question_7"){
	
	correct_dat <- data.frame(ID = 1:6,
                      var1 = c(10,NA,130,440,50,360),
                      var2 = c(170,480,290,NA,10,220),
                      var3 = c(330,145,NA,260,70,380),
                      var4 = c(190,310,220,230,40,350),
                      var5 = c(360,NA,NA,290,110,125),
                      var6 = c(35,640,350,160,170,NA),
                      var7 = c(1290,10,120,230,NA,50))
	
	if(!exists("dat")){
		out <- list(message = "The data.frame `dat` does not exist. Do not edit this object.", correct = FALSE, location = "append")
	} else {
		if(!identical(dat,correct_dat)){
			out <- list(message = "The data.frame `dat` appears to have been altered. Do not alter this object. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
		} else {
			if(exists("data_select.variables")){
				out <- list(message = "The intermediate data.frame `data_select.variables` still exists in the workspace. One of the advantages of using pipes is that you can avoid saving intermediate objects that clogs up your workspace. Re-write the code to remove this object.", correct = FALSE, location = "append")
			} else {
				if(exists("data_remove.missing1")){
				out <- list(message = "The intermediate data.frame `data_remove.missing1` still exists in the workspace. One of the advantages of using pipes is that you can avoid saving intermediate objects that clogs up your workspace. Re-write the code to remove this object.", correct = FALSE, location = "append")
				} else {
					if(exists("data_remove.missing2")){
						out <- list(message = "The intermediate data.frame `data_remove.missing2` still exists in the workspace. One of the advantages of using pipes is that you can avoid saving intermediate objects that clogs up your workspace. Re-write the code to remove this object.", correct = FALSE, location = "append")
					} else {
						if(!exists("data_final")){
								out <- list(message = "There is no object saved as `data_final`.", correct = FALSE, location = "append")
						} else {
								if(!identical(data_final,correct_dat %>% select(ID,var3,var5) %>% filter(!is.na(var3)) %>% filter(!is.na(var5)) %>% mutate(total = var3 + var5))) {
									out <- list(message = "The `data_final` from the submitted code does not match the `data_final` from the original code. Check that there are no errors in the submitted code.", correct = FALSE, location = "append")
								}
							}
						}
					}
				}
			}
		}
	}

if(label == "question_8"){
	
	correct_brightside <- data.frame(line = c(1,2,NA,3,4),
                      word1 = c("coming","and","you","gotta","because"),
                      band = c("brandon","dave",NA,"mark","ronnie"),
                      word2 = c("out","I've","sit","gotta","I"),
                      word3 = c("of","been","there","be","want"),
                      word4 = c("my","doing","in","down","it"),
                      word5 = c("cage","just","your",NA,"all"),
                      word6 = c(NA,"fine","heartache",NA,NA))
	
	if(!exists("brightside")){
		out <- list(message = "The data.frame `brightside` does not exist. Do not edit this object.", correct = FALSE, location = "append")
	} else {
		if(!identical(brightside,correct_brightside)){
			out <- list(message = "The data.frame `brightside` appears to have been altered. Do not alter this object. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
		} else {
			if(!exists("brightside_final")){
				out <- list(message = "No object saved as `brightside_final`.", correct = FALSE, location = "append")
			} else {
				if(!identical(brightside_final,correct_brightside %>% filter(!is.na(line)) %>% select(line,word1,word2:word6))){
					out <- list(message = "The object `final_brightside` does not match the correct answer. Check there are no errors in the code.", correct = FALSE, location = "append")
				}
			}
		}
	}
}  

if(label == "question_9"){
	
	correct_ratings <- data.frame(ID = 1:40,
                         age = c(75,94,83,88,69,80,76,93,74,60,72,69,85,74,92,61,92,92,66,67,88,82,75,93,89,67,70,64,68,91,80,71,84,89,73,93,90,78,85,60),
                         stimuli_1 = c(1,7,6,6,6,5,3,1,4,3,6,1,6,3,3,4,5,4,5,1,5,5,3,1,7,5,6,5,5,1,2,7,2,2,4,1,2,7,5,4),
                         stimuli_2 = c(6,1,5,6,6,7,3,3,7,6,7,7,7,2,1,7,5,5,4,6,3,5,3,3,3,7,2,4,4,2,2,2,5,2,4,5,4,5,4,7),
                         stimuli_3 = c(7,5,4,2,1,1,4,3,5,5,5,4,4,4,5,1,7,5,4,1,1,1,2,4,6,5,6,2,5,4,3,5,2,6,7,1,1,5,3,7),
                         stimuli_4 = c(1,1,2,4,5,1,1,5,6,6,4,6,2,1,3,3,4,2,4,6,2,7,5,3,2,1,7,2,6,3,3,7,3,6,6,4,5,7,4,3),
                         stimuli_5 = c(3,5,3,5,7,7,2,6,6,5,4,1,5,2,4,5,5,2,6,5,5,3,6,3,6,3,3,2,5,7,1,5,7,2,4,3,5,5,4,7),
                         stimuli_6 = c(2,1,4,7,6,3,1,5,1,2,5,6,5,1,5,2,5,1,1,3,2,6,1,3,7,4,2,7,6,2,5,7,4,1,5,3,1,4,7,5),
                         stimuli_7 = c(2,7,1,3,3,5,4,4,2,3,4,3,2,1,6,4,7,2,3,5,2,2,2,1,6,3,3,3,3,2,1,4,5,3,3,2,4,1,3,7),
                         stimuli_8 = c(4,7,3,4,1,5,3,6,3,7,4,4,1,5,6,6,3,4,2,6,6,1,1,2,4,2,1,2,6,4,3,2,7,4,1,7,5,7,7,3),
                         stimuli_9 = c(6,7,3,4,4,2,3,1,3,7,5,2,3,5,6,6,4,5,4,1,4,3,5,6,3,2,7,5,1,6,1,5,5,7,7,2,1,7,6,3),
                         stimuli_10 = rep(-99,40),
                         stimuli_11 = rep(1,40),
                         stimuli_12 = c(3,7,3,7,5,2,2,4,5,7,3,1,7,6,4,7,4,7,3,4,2,7,7,2,7,4,7,2,6,3,4,7,7,6,5,4,6,7,2,2))
                         
    ratings_answer <- correct_ratings %>%
  select(ID,age,stimuli_1,stimuli_2,stimuli_3,stimuli_4,stimuli_5,stimuli_6,stimuli_7,stimuli_8,stimuli_9,stimuli_12) %>%
  filter(age >= 65) %>%
  mutate(total = stimuli_1 + stimuli_2 + stimuli_3 + stimuli_4 + stimuli_5 + stimuli_6 + stimuli_7 + stimuli_8 + stimuli_9 + stimuli_12)
	
	if(!exists("ratings")){
		out <- list(message = "The data.frame `ratings` does not exist. Do not edit this object.", correct = FALSE, location = "append")
	} else {
		if(!identical(ratings,correct_ratings)){
			out <- list(message = "The data.frame `ratings` does not match the original input. Do not edit this object. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
		} else {
			if(!exists("ratings_final")){
				out <- list(message = "The data.frame `ratings_final` does not exist. Make sure to save the answer as `ratings_final`.", correct = FALSE, location = "append")
			} else {
				if("stimuli_10" %in% colnames(ratings_final) | "stimuli_11" %in% colnames(ratings_final)){
					out <- list(message = "At least one of the problematic variables are still in the `ratings_final`. Be sure to remove 'stimuli_10' and 'stimuli_11' from the dataset.", correct = FALSE, location = "append")
				} else {
					if(nrow(ratings_final) != nrow(ratings_answer)){
						out <- list(message = "The incorrect number of participants is in the `ratings_final`. Remember, you only want to include participants who are 65-years-old or older.", correct = FALSE, location = "append")
					} else {
						if(!("total" %in% colnames(ratings_final))){
							out <- list(message = "There is no variable called 'total' in the data.frame `ratings_final`. Make sure to compute the sum of valid variables and save it as the variable 'total'.", correct = FALSE, location = "append")
						} else {
							if(!identical(ratings_final$total,ratings_answer$total)){
								out <- list(message = "The variable 'total' does not appear to equal the sum of valid stimuli. Check for any errors in the submitted code.", correct = FALSE, location = "append")
							}
						}
					}
				}
			}
		}
	}
}  
      
return(out)
}

tutorial_options(exercise.checker = checker)
```

## Introduction

This is the third of the weekly exercises. These exercises are designed to reinforce content taught each week. Typically, they consist of quiz questions and R exercises that require you to enter code into a box. These exercises are split into beginner and advance sections. It is expected that students can complete the beginner sections of each weekly exercise, with the advanced sections designed for students who want an extra challenge or learn additional functions in R.If you are struggling, each exercise comes with a number of hints that may be helpful.

## Basic Exercises

### Question 1

In the code below, an object named `countries` is a character vector. Using the `==` operator and the `sum()` function, determine how many of the countries is "Scotland". Save the number as an object called `Scotland_N`.

```{r question_1-setup}
countries <- c("Scotland","England","France","Wales","Scotland","Australia","Scotland","England","United States","Iceland","Scotland","Spain","Scotland","Swaziland","Scotland","Switzerland","Scotland","England","France","Wales","Scotland","Australia","Scotland","England","United States","Iceland","Scotland","Spain","Scotland","Swaziland","Scotland","Switzerland")
```

```{r question_1, exercise=TRUE}
countries
```

```{r question_1-hint-1}
Using a logical operator like `==` returns a logical vector. Logical vectors are a special type of Factor class that at times can be treated as numeric, with FALSE = 0 and TRUE = 1.
```

```{r question_1-hint-2}
When using the `==` operator, the two parts have to be an exact match. If there are any spelling mistakes, typos, or differences in capitalisation, the operator will return a `FALSE` value.

Next hint will show the solution...
```

```{r question_1-solution}
countries

temp <- countries == "Scotland"

Scotland_N <- sum(temp)
```

```{r question_1-check}
checker()
```

### Question 2

In the code below, an object named `numbers` is a numeric vector. How many of the numbers are less than 53? Save the answer as an object called `less_than_53`.

```{r question_2-setup}
numbers <- c(71,66,64,80,19,96,33,60,61,20,37,14,74,45,70,52,43,93,53,42,36,91,82,22,9,26,95,21,75,16,52,7,36,90,45,59,60,54,95,35,38,97,49,71,38,70,6,96,85,43,45,99,51,78,49,72,44,96,62,74,62,85,17,22,89,23,98,5,80,37,17,40,75,48,3,76,88,71,80,46,88,13,34,58,94,24,28,27,68,63,17,97,23,95,37,80,2,40,36,8)
```

```{r question_2, exercise=TRUE}
numbers

```

```{r question_2-hint-1}
Which operator tests for a "less than" relationship?
```

```{r question_2-hint-2}
Using a logical operator returns a logical vector. Logical vectors are a special type of Factor class that at times can be treated as numeric, with FALSE = 0 and TRUE = 1. You can use the `sum()` function to add all the `TRUE` responses.

Next hint will show the solution...
```

```{r question_2-solution}
less_than_53 <- sum(numbers < 53)
```

```{r question_2-check}
checker()
```

### Question 3

In the code below, an object named `numbers` is data.frame. One of the variables in the data.frame is called "remove". Filter out all participants that have a value of "Exclude" for this variable and save the result as `numbers_filtered`.

```{r question_3-setup}
numbers <- data.frame(ID = 1:100,
                      remove = c('Include','Exclude','Exclude','Exclude','Exclude','Exclude','Include','Include','Include','Include','Include','Include','Include','Include','Exclude','Include','Exclude','Exclude','Include','Include','Include','Include','Exclude','Include','Exclude','Exclude','Include','Include','Exclude','Exclude','Include','Include','Include','Exclude','Include','Include','Exclude','Include','Include','Exclude','Include','Exclude','Include','Include','Exclude','Exclude','Exclude','Exclude','Exclude','Include','Include','Include','Include','Exclude','Exclude','Exclude','Include','Include','Exclude','Exclude','Include','Exclude','Exclude','Include','Include','Include','Exclude','Include','Exclude','Include','Include','Include','Exclude','Include','Exclude','Include','Include','Exclude','Exclude','Include','Include','Include','Include','Include','Include','Exclude','Include','Include','Exclude','Include','Exclude','Exclude','Include','Include','Exclude','Exclude','Exclude','Exclude','Include','Exclude'),
                      var1 = c(71,66,64,80,19,96,33,60,61,20,37,14,74,45,70,52,43,93,53,42,36,91,82,22,9,26,95,21,75,16,52,7,36,90,45,59,60,54,95,35,38,97,49,71,38,70,6,96,85,43,45,99,51,78,49,72,44,96,62,74,62,85,17,22,89,23,98,5,80,37,17,40,75,48,3,76,88,71,80,46,88,13,34,58,94,24,28,27,68,63,17,97,23,95,37,80,2,40,36,8))
```

```{r question_3, exercise=TRUE}
head(numbers) #Run this line of code to see the top 6 lines of the data.frame

```

```{r question_3-hint-1}
Use the `filter()` function to remove participants.
```

```{r question_3-hint-2}
You want to exclude participants with a certain value for the variable named 'remove'. Use the != operator to determine which participants do not have this value.

Next hint will show the solution...
```

```{r question_3-solution}
numbers_filtered <- filter(numbers,remove != "Exclude")
```

```{r question_3-check}
checker()
```

### Question 4

In the code below, there is a data.frame called `personality`, where six participants were measured on the Big-5 personality dimensions (openness, conscientiousness, extraversion, agreeableness, and neuroticism). However, you are only interested in the conscientiousness and neuroticism dimensions. Use a tidyverse function to create a dataset with only the ID, conscientiousness, and neuroticism variables and save the result as `personality_cleaned`.

```{r question_4-setup}
personality <- data.frame(ID = 1:6,
                      openness = c(3,5,1,4,2,3),
                      conscientiousness = c(1,4,2,3,3,2),
                      extraversion = c(3,5,4,2,2,3),
                      agreeableness = c(1,3,2,2,5,3),
                      neuroticism = c(3,3,4,2,1,5))
```

```{r question_4, exercise=TRUE}
personality

```

```{r question_4-hint-1}
Which tidyverse function can you use to select the variables you are interested in?
```

```{r question_4-hint-2}
Remember, we are after a data.frame with three variables: "ID", "conscientiousness", and "neuroticism".

Next hint will show the solution...
```

```{r question_4-solution}
personality_cleaned <- filter(personality,ID,conscientiousness,neuroticism)
```

```{r question_4-check}
checker()
```

### Question 5

You have conducted a study measuring how many minutes participants engage in physical exercise each day. You have measured 6 participants every day for a week - this data is saved below as `phys_exer`. You wish to analyse the total number of minutes participants spent exercising during the week. Use a tidyverse function to create a new data.frame called `phys_exer_total` with a new variable called `total` which is the sum of minutes across the seven days.

```{r question_5-setup}
phys_exer <- data.frame(ID = 1:6,
                      sunday = c(0,15,10,40,0,30),
                      monday = c(10,40,20,30,0,20),
                      tuesday = c(30,15,40,20,0,30),
                      wednesday = c(10,30,20,20,0,30),
                      thursday = c(30,30,40,20,10,15),
                      friday = c(5,60,30,10,10,0),
                      saturday = c(120,0,10,20,10,0))
```

```{r question_5, exercise=TRUE}
phys_exer

```

```{r question_5-hint-1}
Which tidyverse function can you use to mutate the variables to create a new variable?
```

```{r question_5-hint-2}
Remember, we are after a data.frame with a new variable called "total" that the amount of minutes of the seven days added together.

Next hint will show the solution...
```

```{r question_5-solution}
phys_exer_total <- mutate(phys_exer,total = sunday + monday + tuesday + wednesday + thursday + friday + saturday)
```

```{r question_5-check}
checker()
```

### Question 6

After showing your supervisor your work from Question 5, they flippantly remark that perhaps you should analyse the mean number of minutes participants exercise per day, rather than the total number of minutes across the week. Edit the code below so that the variable `total` is the mean and not the sum.

```{r question_6-setup}
phys_exer <- data.frame(ID = 1:6,
                      sunday = c(0,15,10,40,0,30),
                      monday = c(10,40,20,30,0,20),
                      tuesday = c(30,15,40,20,0,30),
                      wednesday = c(10,30,20,20,0,30),
                      thursday = c(30,30,40,20,10,15),
                      friday = c(5,60,30,10,10,0),
                      saturday = c(120,0,10,20,10,0))
```

```{r question_6, exercise=TRUE,exercise.lines = 5}
phys_exer

phys_exer_total <- mutate(phys_exer,total = sunday + monday + tuesday + wednesday + thursday + friday + saturday)

```

```{r question_6-hint-1}
The mean (also called the average) can be calculated by adding up all the values and dividing the total by the number of values.
```

```{r question_6-hint-2}
Sometimes you need to use brackets to tell R what to divide across...

Next hint will show the solution...
```

```{r question_6-solution}
#The total score is divided by 7 to produce the average.

phys_exer_total <- mutate(phys_exer,total = (sunday + monday + tuesday + wednesday + thursday + friday + saturday)/7)
```

```{r question_6-check}
checker()
```

### Question 7

In the code below, the data.frame `dat` is being prepared for data analysis. Re-write the code to include pipes (%>%) and avoid saving intermediate data.frames. Save the final result under `data_final`.

```{r question_7-setup}
dat <- data.frame(ID = 1:6,
                      var1 = c(10,NA,130,440,50,360),
                      var2 = c(170,480,290,NA,10,220),
                      var3 = c(330,145,NA,260,70,380),
                      var4 = c(190,310,220,230,40,350),
                      var5 = c(360,NA,NA,290,110,125),
                      var6 = c(35,640,350,160,170,NA),
                      var7 = c(1290,10,120,230,NA,50))
```

```{r question_7, exercise=TRUE,exercise.lines = 8}
dat
data_select.variables <- select(dat,ID,var3,var5)
data_remove.missing1 <- filter(data_select.variables,!is.na(var3))
data_remove.missing2 <- filter(data_remove.missing1,!is.na(var5))
data_final <- mutate(data_remove.missing2,total = var3 + var5)
```

```{r question_7-hint-1}
Pipes (%>%) pass the output from one command and enter it as the first argument of the next command. By using pipes, you can avoid saving intermediate datasets.
```

```{r question_7-hint-2}
Pipes can be unintuitive at first. If you're having difficulty understanding how to use pipes, try Googling "How to use pipes in R".

Next hint will show the solution...
```

```{r question_7-solution}
dat
data_final <- select(dat,ID,var3,var5) %>%
  filter(!is.na(var3)) %>%
  filter(!is.na(var5)) %>%
  mutate(total = var3 + var5)
```

```{r question_7-check}
checker()
```

### Question 8

In the code below, the data.frame `brightside` is being prepared for data analysis. However, the code is not running correctly. There are three errors in the code below. Fix the errors so the code runs properly.

```{r question_8-setup}
brightside <- data.frame(line = c(1,2,NA,3,4),
                      word1 = c("coming","and","you","gotta","because"),
                      band = c("brandon","dave",NA,"mark","ronnie"),
                      word2 = c("out","I've","sit","gotta","I"),
                      word3 = c("of","been","there","be","want"),
                      word4 = c("my","doing","in","down","it"),
                      word5 = c("cage","just","your",NA,"all"),
                      word6 = c(NA,"fine","heartache",NA,NA))
```

```{r question_8, exercise=TRUE,exercise.lines = 8}
brightside_final <- brightside %>%
  filter(brightside,!is.na(line) %>%
  select(line word1, word2, word3, word4, word5, word6)
```

```{r question_8-hint-1}
If you pass an object to a function using a pipe, you do not specify the first argument.
```

```{r question_8-hint-2}
Common errors in code are missing things, such as brackets and commas...

Next hint will show the solution...
```

```{r question_8-solution}
brightside_final <- brightside %>%
  filter(!is.na(line)) %>%
  select(line, word1, word2, word3, word4, word5, word6)

#the first argument is not needed for the `filter()` function.
#there is a missing bracket for the `filter()` function.
#there is a missing comma for the `select()` function.
```

```{r question_8-check}
checker()
```

### Question 9

You are interested in how older adults make judgements of trustworthiness. You have conducted a study with 40 participants, where participants gave ratings of trustworthiness to 12 stimuli. This data is saved as the object `ratings`. However, after collecting the data, you noticed there is an issue with stimuli_10 and stimuli_11, and they needs to be excluded. Prepare the data.frame for data analysis by doing the following:

1. Remove the problematic variables.
1. Remove participants that are not 65 years or older.
1. Calculate a new variable called `total` that is the sum of the remaining `stimuli` variables.

Save the new data.frame as `ratings_final`.

```{r question_9-setup}
ratings <- data.frame(ID = 1:40,
                         age = c(75,94,83,88,69,80,76,93,74,60,72,69,85,74,92,61,92,92,66,67,88,82,75,93,89,67,70,64,68,91,80,71,84,89,73,93,90,78,85,60),
                         stimuli_1 = c(1,7,6,6,6,5,3,1,4,3,6,1,6,3,3,4,5,4,5,1,5,5,3,1,7,5,6,5,5,1,2,7,2,2,4,1,2,7,5,4),
                         stimuli_2 = c(6,1,5,6,6,7,3,3,7,6,7,7,7,2,1,7,5,5,4,6,3,5,3,3,3,7,2,4,4,2,2,2,5,2,4,5,4,5,4,7),
                         stimuli_3 = c(7,5,4,2,1,1,4,3,5,5,5,4,4,4,5,1,7,5,4,1,1,1,2,4,6,5,6,2,5,4,3,5,2,6,7,1,1,5,3,7),
                         stimuli_4 = c(1,1,2,4,5,1,1,5,6,6,4,6,2,1,3,3,4,2,4,6,2,7,5,3,2,1,7,2,6,3,3,7,3,6,6,4,5,7,4,3),
                         stimuli_5 = c(3,5,3,5,7,7,2,6,6,5,4,1,5,2,4,5,5,2,6,5,5,3,6,3,6,3,3,2,5,7,1,5,7,2,4,3,5,5,4,7),
                         stimuli_6 = c(2,1,4,7,6,3,1,5,1,2,5,6,5,1,5,2,5,1,1,3,2,6,1,3,7,4,2,7,6,2,5,7,4,1,5,3,1,4,7,5),
                         stimuli_7 = c(2,7,1,3,3,5,4,4,2,3,4,3,2,1,6,4,7,2,3,5,2,2,2,1,6,3,3,3,3,2,1,4,5,3,3,2,4,1,3,7),
                         stimuli_8 = c(4,7,3,4,1,5,3,6,3,7,4,4,1,5,6,6,3,4,2,6,6,1,1,2,4,2,1,2,6,4,3,2,7,4,1,7,5,7,7,3),
                         stimuli_9 = c(6,7,3,4,4,2,3,1,3,7,5,2,3,5,6,6,4,5,4,1,4,3,5,6,3,2,7,5,1,6,1,5,5,7,7,2,1,7,6,3),
                         stimuli_10 = rep(-99,40),
                         stimuli_11 = rep(1,40),
                         stimuli_12 = c(3,7,3,7,5,2,2,4,5,7,3,1,7,6,4,7,4,7,3,4,2,7,7,2,7,4,7,2,6,3,4,7,7,6,5,4,6,7,2,2))
```

```{r question_9, exercise=TRUE,exercise.lines = 10}
ratings
```

```{r question_9-hint-1}
Have a look at the `ratings` data.frame so you have an idea of how it is structured.
```

```{r question_9-hint-2}
Use tidyverse functions, such as `select()`, `filter()`, and `mutate()` to achieve your objective.

Next hint will show the solution...
```

```{r question_9-solution}
ratings_final <- ratings %>%
  select(ID,age,stimuli_1,stimuli_2,stimuli_3,stimuli_4,stimuli_5,stimuli_6,stimuli_7,stimuli_8,stimuli_9,stimuli_12) %>%
  filter(age >= 65) %>%
  mutate(total = stimuli_1 + stimuli_2 + stimuli_3 + stimuli_4 + stimuli_5 + stimuli_6 + stimuli_7 + stimuli_8 + stimuli_9 + stimuli_12)
```

```{r question_9-check}
checker()
```

## Advanced Exercises


