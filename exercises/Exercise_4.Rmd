---
output: learnr::tutorial
runtime: shiny_prerendered
---
```{r setup, include=FALSE}
library(learnr)
require(tidyverse)
require(ggplot2)

knitr::opts_chunk$set(echo = FALSE)
```
```{r eval = FALSE}
checker <- function(label,user_code,solution_code,check_code,envir_result,evaluate_result,envir_prep,...){
  
  envir_result
  out <- list(message = sample(c("Good Job!",
                                 "Well done!",
                                 "Great stuff!",
                                 "That is correct!",
                                 "Correct! You are really good at this."),1), correct = TRUE, location = "append")
  
#Question 2
if(label == "question_2"){

	correct_plot.data <- data.frame(var_x = c(0.2,0.32,0.81,-0.38,-0.52,-0.42,-1.52,-0.73,-1.33,1.03,0.53,1.3,-1.28,-0.2,1.51,-0.15,0.02,1.25,1.06,-0.42,2.13,-0.28,-1.2,-1.18,-1.19,-1.36,-0.51,0.08,0.78,0.15,0.27,-0.79,-1.14,-0.84,-0.23,-0.67,-0.9,0.31,0.63,1.42),
  							var_y = c(-0.42,-0.38,2,-0.43,1.01,-0.19,-0.64,-1.12,-0.25,2.06,-0.53,1.18,-0.12,0.18,1.88,-1.78,0.35,1.23,0.72,1.75,1.02,0.05,-1.49,0.16,-0.56,-0.52,0.27,0.76,-0.45,-1.16,-0.87,-0.85,-2.1,-0.25,-0.78,-0.67,-0.15,0.81,0.31,-0.04))
  	
  	correct_plot.output <- ggplot(data = correct_plot.data,aes(x = var_x, y = var_y)) +
  		geom_point()

 	
 	if(!exists("plot.data")){
 		out <- list(message = "No object saved as plot.data. Do not alter the object called `plot.data`.", correct = FALSE, location = "append")
 	} else {
 		if(!identical(plot.data,correct_plot.data)){
 			out <- list(message = "The object `plot.data` appears to have been alter. Do not alter this object. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
 		} else {
 			
 			if(!exists("plot.output")){
 				out <- list(message = "There is no object called `plot.output`. Save the final plot as this object.", correct = FALSE, location = "append")
 			}
 		}
 	}
}

#Label 3
if(label == "question_3"){

	correct_plot.data <- data.frame(var_x = c(0.2,0.32,0.81,-0.38,-0.52,-0.42,-1.52,-0.73,-1.33,1.03,0.53,1.3,-1.28,-0.2,1.51,-0.15,0.02,1.25,1.06,-0.42,2.13,-0.28,-1.2,-1.18,-1.19,-1.36,-0.51,0.08,0.78,0.15,0.27,-0.79,-1.14,-0.84,-0.23,-0.67,-0.9,0.31,0.63,1.42),
  							var_y = c(-0.42,-0.38,2,-0.43,1.01,-0.19,-0.64,-1.12,-0.25,2.06,-0.53,1.18,-0.12,0.18,1.88,-1.78,0.35,1.23,0.72,1.75,1.02,0.05,-1.49,0.16,-0.56,-0.52,0.27,0.76,-0.45,-1.16,-0.87,-0.85,-2.1,-0.25,-0.78,-0.67,-0.15,0.81,0.31,-0.04))
  	
  	correct_plot.output <- ggplot(data = correct_plot.data,aes(x = var_x, y = var_y)) +
  		geom_point()
 	
 	if(!exists("plot.data")){
 		out <- list(message = "No object saved as plot.data. Do not alter the object called `plot.data`.", correct = FALSE, location = "append")
 	} else {
 		if(!identical(plot.data,correct_plot.data)){
 			out <- list(message = "The object `plot.data` appears to have been alter. Do not alter this object. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
 		} else {
 			
 			if(!exists("plot.output")){
 				out <- list(message = "There is no object called `plot.output`. Save the final plot as this object.", correct = FALSE, location = "append")
 			} else {
 				out <- list(message = "Unfortunately the checker cannot determine whether you have the correct answer for this question; however, you can determine whether you have the correct answer yourself by comparing the graphs from this question to that of Question 2. Do the points have a different shape?", correct = TRUE, location = "append")
 				}
 			}
 		}
 	}

#Question 4
 if(label == "question_4"){

	correct_plot.data <- data.frame(var1 = c(0.2,0.32,0.81,-0.38,-0.52,-0.42,-1.52,-0.73,-1.33,1.03,0.53,1.3,-1.28,-0.2,1.51,-0.15,0.02,1.25,1.06,-0.42,2.13,-0.28,-1.2,-1.18,-1.19,-1.36,-0.51,0.08,0.78,0.15,0.27,-0.79,-1.14,-0.84,-0.23,-0.67,-0.9,0.31,0.63,1.42),
  							var2 = c(-0.42,-0.38,2,-0.43,1.01,-0.19,-0.64,-1.12,-0.25,2.06,-0.53,1.18,-0.12,0.18,1.88,-1.78,0.35,1.23,0.72,1.75,1.02,0.05,-1.49,0.16,-0.56,-0.52,0.27,0.76,-0.45,-1.16,-0.87,-0.85,-2.1,-0.25,-0.78,-0.67,-0.15,0.81,0.31,-0.04),
  							group_member = factor(c('group_3','group_2','group_1','group_2','group_2','group_2','group_2','group_3','group_3','group_2','group_2','group_2','group_2','group_2','group_3','group_2','group_2','group_1','group_3','group_1','group_2','group_1','group_1','group_3','group_3','group_1','group_2','group_1','group_2','group_1','group_3','group_2','group_1','group_3','group_3','group_1','group_3','group_2','group_2','group_1')))
  	
  	correct_plot.output <- ggplot(data = correct_plot.data,aes(x = var_x, y = var_y)) +
  		geom_point(aes(colour = group_member))
 	
 	if(!exists("plot.data")){
 		out <- list(message = "No object saved as plot.data. Do not alter the object called `plot.data`.", correct = FALSE, location = "append")
 	} else {
 		if(!identical(plot.data,correct_plot.data)){
 			out <- list(message = "The object `plot.data` appears to have been alter. Do not alter this object. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
 		} else {
 			
 			if(!exists("plot.output")){
 				out <- list(message = "There is no object called `plot.output`. Save the final plot as this object.", correct = FALSE, location = "append")
 			} else {
 				out <- list(message = "Unfortunately the checker cannot determine whether you have the correct answer for this question, but there is an example of a possible solution if you click through all the hints above.", correct = TRUE, location = "append")
 			}
 		}
 	}
 }

#Question 5
 if(label == "question_5"){

correct_attachment.data <- data.frame(ID = 1:40,
							attachment = c('secure','secure','anxious ambivalent','anxious avoidant','anxious avoidant','secure','secure','secure','secure','secure','secure','secure','secure','secure','secure','secure','anxious ambivalent','anxious avoidant','secure','anxious avoidant','secure','anxious ambivalent','anxious ambivalent','secure','secure','secure','anxious ambivalent','secure','secure','anxious ambivalent','secure','secure','secure','anxious avoidant','secure','secure','anxious ambivalent','secure','secure','anxious avoidant'))


correct_plot.output <- ggplot(data = correct_attachment.data,aes(x = var_x, y = var_y)) +
  		geom_point(aes(colour = group_member))
 	
 	if(!exists("attachment.data")){
 		out <- list(message = "No object saved as attachment.data. Do not alter the object called `attachment.data`.", correct = FALSE, location = "append")
 	} else {
 		if(!identical(attachment.data,correct_attachment.data)){
 			out <- list(message = "The object `attachment.data` appears to have been alter. Do not alter this object. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
 		} else {
 			
 			if(!exists("plot.output")){
 				out <- list(message = "There is no object called `plot.output`. Save the final plot as this object.", correct = FALSE, location = "append")
 			} else {
 				out <- list(message = "Unfortunately the checker cannot determine whether you have the correct answer for this question, but there is an example of a possible solution if you click through all the hints above.", correct = TRUE, location = "append")
 			}
 		}
 	}
 }

#Question 6

 if(label == "question_6"){

correct_looking.data <- data.frame(ID = 1:30,
looking.time = c(11.88,19.11,13.32,23.96,10.91,7.44,13.89,11.01,11.36,16.34,9.49,4.29,3.59,3.42,12,6.95,13,8.63,3.01,5.09,13.58,3.07,26.14,10.5,17.87,14.78,1.33,11.05,3.53,0.68))


correct_plot.output <- ggplot(data = correct_looking.data,aes(x = var_x, y = var_y)) +
  		geom_density()
 	
 	if(!exists("looking.data")){
 		out <- list(message = "No object saved as looking.data. Do not alter the object called `looking.data`.", correct = FALSE, location = "append")
 	} else {
 		if(!identical(looking.data,correct_looking.data)){
 			out <- list(message = "The object `looking.data` appears to have been alter. Do not alter this object. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
 		} else {
 			
 			if(!exists("plot.output")){
 				out <- list(message = "There is no object called `plot.output`. Save the final plot as this object.", correct = FALSE, location = "append")
 			} else {
 				out <- list(message = "Unfortunately the checker cannot determine whether you have the correct answer for this question, but there is an example of a possible solution if you click through all the hints above.", correct = TRUE, location = "append")
 			}
 		}
 	}
 }
  
return(out)
}

tutorial_options(exercise.checker = checker)
```

## Introduction

This is the fourth of the weekly exercises. These exercises are designed to reinforce content taught each week. Typically, they consist of quiz questions and R exercises that require you to enter code into a box. These exercises are split into beginner and advance sections. It is expected that students can complete the beginner sections of each weekly exercise, with the advanced sections designed for students who want an extra challenge or learn additional functions in R. If you are struggling, each exercise comes with a number of hints that may be helpful.

## Basic Exercises

### Before you start...

Be aware that the checker cannot evaluate visual information. So while submitting your answer may return a green "correct" message, it is up to you to evaluate whether your plot meets the objective.

### Question 1

```{r question_1-setup}
  example.data <- data.frame(var1 = c(0.2,0.32,0.81,-0.38,-0.52,-0.42,-1.52,-0.73,-1.33,1.03,0.53,1.3,-1.28,-0.2,1.51,-0.15,0.02,1.25,1.06,-0.42,2.13,-0.28,-1.2,-1.18,-1.19,-1.36,-0.51,0.08,0.78,0.15,0.27,-0.79,-1.14,-0.84,-0.23,-0.67,-0.9,0.31,0.63,1.42),
  							var2 = c(-0.42,-0.38,2,-0.43,1.01,-0.19,-0.64,-1.12,-0.25,2.06,-0.53,1.18,-0.12,0.18,1.88,-1.78,0.35,1.23,0.72,1.75,1.02,0.05,-1.49,0.16,-0.56,-0.52,0.27,0.76,-0.45,-1.16,-0.87,-0.85,-2.1,-0.25,-0.78,-0.67,-0.15,0.81,0.31,-0.04))
```

```{r question_1-quiz}
quiz(
  question("Below is the code to create a graphic using ggplot. Select all the correct statements about this code.",
    answer("The first argument in the `ggplot()` function is the data.frame that includes the variables you wish to plot.",correct = TRUE),
    answer("Specifying what variables are on the x- and y-axis does NOT require the `aes()` function."),
    answer("The plot contains two geoms, one for the points on the scatterplot, and one for the line-of-best-fit.",correct = TRUE),
    answer("No more additional geoms could be added to this plot."),
    answer("The `colour = 'red'` aesthetic makes the points in the figure red.",correct = TRUE),
  allow_retry = TRUE)
)
```

```{r question_1, exercise=TRUE}
#Run this code to see the plot it generates.

ggplot(data = example.data,aes(x = var1, y = var2)) +
  geom_point(colour = "red") +
  geom_smooth(method = "lm")
```

### Question 2

In the code below, there is an object called `plot.data`, which is a data.frame with two variables. Complete the code within the `ggplot()` function to complete the scatterplot. Put the variable `var_x` on the x-axis, and `var_y` on the y-axis.

```{r question_2-setup}
  plot.data <- data.frame(var_x = c(0.2,0.32,0.81,-0.38,-0.52,-0.42,-1.52,-0.73,-1.33,1.03,0.53,1.3,-1.28,-0.2,1.51,-0.15,0.02,1.25,1.06,-0.42,2.13,-0.28,-1.2,-1.18,-1.19,-1.36,-0.51,0.08,0.78,0.15,0.27,-0.79,-1.14,-0.84,-0.23,-0.67,-0.9,0.31,0.63,1.42),
  							var_y = c(-0.42,-0.38,2,-0.43,1.01,-0.19,-0.64,-1.12,-0.25,2.06,-0.53,1.18,-0.12,0.18,1.88,-1.78,0.35,1.23,0.72,1.75,1.02,0.05,-1.49,0.16,-0.56,-0.52,0.27,0.76,-0.45,-1.16,-0.87,-0.85,-2.1,-0.25,-0.78,-0.67,-0.15,0.81,0.31,-0.04))
```

```{r question_2, exercise=TRUE,exercise.lines = 5}
#plot.data

plot.output <- ggplot(data = ,aes(x = , y = )) +
  geom_point()

plot.output
```

```{r question_2-hint-1}
You will need to add a data.frame to the `ggplot()` function.
```

```{r question_2-hint-2}
You will need to add which variables are on the x- and y-axes within the `aes()` function.

Next hint will show the solution...
```

```{r question_2-solution}
plot.output <- ggplot(data = plot.data,aes(x = var_x, y = var_y)) +
  geom_point()
```

```{r question_2-check}
#checker()
```

### Question 3

Edit the code below so that the points in the figure are a different shape.

```{r question_3-setup}
  plot.data <- data.frame(var_x = c(0.2,0.32,0.81,-0.38,-0.52,-0.42,-1.52,-0.73,-1.33,1.03,0.53,1.3,-1.28,-0.2,1.51,-0.15,0.02,1.25,1.06,-0.42,2.13,-0.28,-1.2,-1.18,-1.19,-1.36,-0.51,0.08,0.78,0.15,0.27,-0.79,-1.14,-0.84,-0.23,-0.67,-0.9,0.31,0.63,1.42),
  							var_y = c(-0.42,-0.38,2,-0.43,1.01,-0.19,-0.64,-1.12,-0.25,2.06,-0.53,1.18,-0.12,0.18,1.88,-1.78,0.35,1.23,0.72,1.75,1.02,0.05,-1.49,0.16,-0.56,-0.52,0.27,0.76,-0.45,-1.16,-0.87,-0.85,-2.1,-0.25,-0.78,-0.67,-0.15,0.81,0.31,-0.04))
```

```{r question_3, exercise=TRUE,exercise.lines = 5}
#plot.data

plot.output <- ggplot(data = plot.data,aes(x = var_x, y = var_y)) +
  geom_point()

plot.output
```

```{r question_3-hint-1}
You can adjust figures by editing the aesthetic components within a geom.
```

```{r question_3-hint-2}
The aesthetic that adjusts the what the points look like is called `shape`.

Next hint will show the solution...
```

```{r question_3-solution}
plot.output <- ggplot(data = plot.data,aes(x = var_x, y = var_y)) +
  geom_point(shape = 2)
#Changing the number at `shape = 2` will produce different shapes.
#Why not experiment with this and see what numbers produce which shapes?
```

```{r question_3-check}
#checker()
```

### Question 4

In the data.frame below (saved as `plot.data`), you have collected data from 40 participants on two variables. Participants are members of one of three groups (this is saved as the variable 'group_member' in the data.frame). You wish to create a scatterplot, where membership in each group is represented by a different colour. Edit the code below to do this.

```{r question_4-setup}
  plot.data <- data.frame(var1 = c(0.2,0.32,0.81,-0.38,-0.52,-0.42,-1.52,-0.73,-1.33,1.03,0.53,1.3,-1.28,-0.2,1.51,-0.15,0.02,1.25,1.06,-0.42,2.13,-0.28,-1.2,-1.18,-1.19,-1.36,-0.51,0.08,0.78,0.15,0.27,-0.79,-1.14,-0.84,-0.23,-0.67,-0.9,0.31,0.63,1.42),
  							var2 = c(-0.42,-0.38,2,-0.43,1.01,-0.19,-0.64,-1.12,-0.25,2.06,-0.53,1.18,-0.12,0.18,1.88,-1.78,0.35,1.23,0.72,1.75,1.02,0.05,-1.49,0.16,-0.56,-0.52,0.27,0.76,-0.45,-1.16,-0.87,-0.85,-2.1,-0.25,-0.78,-0.67,-0.15,0.81,0.31,-0.04),
  							group_member = factor(c('group_3','group_2','group_1','group_2','group_2','group_2','group_2','group_3','group_3','group_2','group_2','group_2','group_2','group_2','group_3','group_2','group_2','group_1','group_3','group_1','group_2','group_1','group_1','group_3','group_3','group_1','group_2','group_1','group_2','group_1','group_3','group_2','group_1','group_3','group_3','group_1','group_3','group_2','group_2','group_1')))
```

```{r question_4, exercise=TRUE,exercise.lines = 5}
#remember, you can call the data.frame below to see what the variable names are...
#plot.data

plot.output <- ggplot(data = plot.data,aes(x = var1, y = var2)) +
  geom_point()

plot.output
```

```{r question_4-hint-1}
You can adjust figures by editing the aesthetic components within a geom.
```

```{r question_4-hint-2}
If aesthetics need to be mapped onto variables in the data.frame, you need to put the command within the `aes()` function.

Next hint will show the solution...
```

```{r question_4-solution}
plot.output <- ggplot(data = plot.data,aes(x = var1, y = var2)) +
  geom_point(aes(colour = group_member))

```

```{r question_4-check}
#checker()
```

### Question 5

You are interested in adult attachment styles in romantic relationships. From 40 participants in a relationship, you measure their attachement style to their partner. Plot the frequency of the three attachment styles in your data.frame as a bar chart and save the result as `plot.output`. The data.frame is saved as the object `attachment.data`.

```{r question_5-setup}
attachment.data <- data.frame(ID = 1:40,
							attachment = c('secure','secure','anxious ambivalent','anxious avoidant','anxious avoidant','secure','secure','secure','secure','secure','secure','secure','secure','secure','secure','secure','anxious ambivalent','anxious avoidant','secure','anxious avoidant','secure','anxious ambivalent','anxious ambivalent','secure','secure','secure','anxious ambivalent','secure','secure','anxious ambivalent','secure','secure','secure','anxious avoidant','secure','secure','anxious ambivalent','secure','secure','anxious avoidant'))
```

```{r question_5, exercise=TRUE,exercise.lines = 5}
#attachment.data

plot.output <- ggplot()

plot.output
```

```{r question_5-hint-1}
The geom to create a bar chart is `geom_bar()`.
```

```{r question_5-hint-2}
Remember to specify which variable is on the x-axis within the `ggplot()` function. Bar charts are a one variable graph, so there is no variable on the y-axis.

Next hint will show the solution...
```

```{r question_5-solution}
plot.output <- ggplot(attachment.data,aes(x = attachment)) +
  geom_bar()

plot.output
```

```{r question_5-check}
#checker()
```

### Question 6

You have conducted a study investigating infant's beliefs in fairness. From thirty 10-month-olds, you measure how long infants attend to (in seconds) a suprising event (a puppet helping another puppet that previously committed a transgression). Plot the the distribution of looking times as either a histogram or density plot and save the result as `plot.output`. The data.frame is saved as the object `looking.data`.

```{r question_6-setup}
looking.data <- data.frame(ID = 1:30,
looking.time = c(11.88,19.11,13.32,23.96,10.91,7.44,13.89,11.01,11.36,16.34,9.49,4.29,3.59,3.42,12,6.95,13,8.63,3.01,5.09,13.58,3.07,26.14,10.5,17.87,14.78,1.33,11.05,3.53,0.68))
```

```{r question_6, exercise=TRUE,exercise.lines = 5}
#looking.data

plot.output <- ggplot()

plot.output
```

```{r question_6-hint-1}
The geom to create a density plot is `geom_density()`. Alternatively, the geom to create a histogram is `geom_histogram()`.
```

```{r question_6-hint-2}
Remember to specify which variable is on the x-axis within the `ggplot()` function. Density plots and histograms are a one variable graphs, so there is no variable on the y-axis.

Next hint will show the solution...
```

```{r question_6-solution}
plot.output <- ggplot(looking.data,aes(x = looking.time)) +
  geom_density()

#OR

plot.output <- ggplot(looking.data,aes(x = looking.time)) +
  geom_histogram()

```

```{r question_6-check}
#checker()
```

## Advanced Exercises

This week's advanced exercises focuses on introducing additional handy functions for making visualisations in ggplot and using visualisation for data diagnostics.

### Question A1 - Customise Labels

By default, ggplot will use the variable names for labels on the axes. You can set custom axis labels by adding `xlab()` or `ylab()` when building your ggplot. You can also add a title to the plot by adding `ggtitle()`:

```{r}
looking.data <- data.frame(ID = 1:30,
looking.time = c(11.88,19.11,13.32,23.96,10.91,7.44,13.89,11.01,11.36,16.34,9.49,4.29,3.59,3.42,12,6.95,13,8.63,3.01,5.09,13.58,3.07,26.14,10.5,17.87,14.78,1.33,11.05,3.53,0.68))
```

```{r,echo = TRUE,eval = FALSE}
ggplot(looking.data,aes(x = looking.time)) +
  geom_density() +
  xlab("Time (in Seconds)") +
  ylab("Proportion of Looking Times") +
  ggtitle("The Length of Time Infants Spend Looking at a Surprising Event")
```

In the box below, data has been collected from 100 participants measuring their IQ. Create a histogram or density plot and customise the labels usings `xlab()` and `ylab()`

```{r question_a1-setup, include = FALSE}
IQ.data <- data.frame(ID = 1:500,
                      country = c(rep("UK",100),rep("France",100),rep("Germany",100),rep("Italy",100),rep("Spain",100)),
                      matricesIQscore = c(83,107,93,111,94,95,98,85,90,119,90,97,115,85,127,93,90,89,83,112,113,114,68,89,137,95,109,99,93,124,111,98,80,119,93,113,76,110,113,113,85,94,74,82,107,105,88,119,91,98,102,101,86,120,102,96,73,94,-99,91,77,129,86,102,115,80,103,80,143,116,91,93,99,102,89,-99,115,100,86,90,85,103,116,104,113,-99,86,78,92,81,87,93,82,99,101,93,85,103,102,101,86,96,105,107,106,117,127,103,113,105,80,117,101,136,99,95,120,103,103,117,111,87,95,66,86,96,94,95,102,103,82,102,100,100,120,77,95,108,93,103,93,120,100,92,92,89,115,76,111,113,102,120,104,98,93,97,120,106,123,83,87,114,123,64,89,105,86,100,105,106,78,89,113,113,83,103,97,108,102,89,92,80,88,85,97,100,101,97,85,106,106,100,131,-99,90,78,99,87,124,112,112,79,85,111,89,83,81,116,113,101,113,82,103,92,111,113,67,107,106,113,104,97,111,103,103,87,64,95,84,104,93,100,127,119,78,115,95,108,109,97,73,116,74,96,109,72,122,111,98,99,103,105,100,102,109,94,79,100,122,93,115,117,106,124,97,91,114,85,83,109,97,100,112,95,85,79,112,96,103,88,117,137,78,111,87,69,112,109,90,111,98,94,102,92,108,102,90,106,87,91,99.8232576822008,99.1994307931569,100.793655065158,98.7142321016784,100.447084571245,100.932283262723,100.239142274897,100.793655065158,100.516398670027,100.100514077331,99.8232576822008,100.862969163941,101.140225559071,100.516398670027,101.348167855419,99.9618858797662,97.6745206199385,101.209539657854,99.1994307931569,100.169828176114,101.833366546898,101.209539657854,100.58571276881,100.031199978549,99.1994307931569,101.278853756637,100.308456373679,101.001597361506,98.9221743980263,101.070911460289,99.4073730895049,99.7539435834182,100.377770472462,100.169828176114,97.1200078296773,101.417481954202,100.308456373679,99.1301166943743,100.100514077331,100.655026867593,100.655026867593,99.6153153858529,100.862969163941,98.991488496809,99.9618858797662,100.516398670027,99.4073730895049,101.694738349333,101.417481954202,101.764052448115,100.447084571245,101.417481954202,100.724340966375,101.348167855419,98.3676616077651,100.308456373679,100.655026867593,99.0608025955916,98.991488496809,100.239142274897,101.764052448115,100.932283262723,100.58571276881,99.1301166943743,100.932283262723,100.655026867593,99.4073730895049,100.031199978549,99.8925717809835,101.971994744463,99.5460012870702,101.764052448115,100.724340966375,99.9618858797662,101.001597361506,101.62542425055,99.6153153858529,101.001597361506,100.516398670027,100.100514077331,100.862969163941,99.3380589907223,101.001597361506,100.516398670027,100.58571276881,99.1994307931569,99.8232576822008,99.6846294846355,101.62542425055,99.8925717809835,99.4766871882876,98.783546200461,-99,100.308456373679,100.793655065158,101.140225559071,101.140225559071,100.377770472462,99.5460012870702,100.308456373679,70,121,100,106,87,104,97,85,106,98,102,91,93,90,109,99,80,102,88,106,111,91,101,97,98,113,111,126,100,82,95,98,78,88,122,95,126,117,113,109,64,120,123,100,87,97,136,83,113,109,93,96,97,74,94,94,107,114,116,91,99,124,88,36,113,97,110,102,115,124,123,67,111,79,103,96,90,100,95,135,76,100,110,98,98,96,90,76,96,140,96,109,-99,96,88,102,86,104,110,106)
)
```

```{r question_a1, exercise=TRUE,exercise.lines = 5}
#IQ.data
```

```{r question_a1-hint-1}
Remember to add the `xlab()` and `ylab()` functions using the `+` symbol.
```

```{r question_a1-hint-2}
You could always copy the code above and change the names...
```

```{r question_a1-solution}
ggplot(IQ.data,aes(x = matricesIQscore)) +
  geom_density() +
  xlab("IQ Score") +
  ylab("Density of total IQ Scores") +
  ggtitle("Distribution of IQ Scores of the Sample")
```

### Question A2 - Data Diagnostics 1

You may have noticed something doesn't look quite right about the distribution of IQ scores above. There appears to be a small number of participants with a IQ score of "-99". Some statistics courses teach that missing values should be coded as an unrealistic value (e.g., -99); however, this can cause some issues if you forget to exclude them or not tell your collaborators/statistics program that these are missing values!

In the box below, use tidyverse functions to remove participants with an IQ score of "-99" and replot the distribution.

```{r question_a3-setup, include = FALSE}
IQ.data <- data.frame(ID = 1:500,
                      country = c(rep("UK",100),rep("France",100),rep("Germany",100),rep("Italy",100),rep("Spain",100)),
                      matricesIQscore = c(83,107,93,111,94,95,98,85,90,119,90,97,115,85,127,93,90,89,83,112,113,114,68,89,137,95,109,99,93,124,111,98,80,119,93,113,76,110,113,113,85,94,74,82,107,105,88,119,91,98,102,101,86,120,102,96,73,94,-99,91,77,129,86,102,115,80,103,80,143,116,91,93,99,102,89,-99,115,100,86,90,85,103,116,104,113,-99,86,78,92,81,87,93,82,99,101,93,85,103,102,101,86,96,105,107,106,117,127,103,113,105,80,117,101,136,99,95,120,103,103,117,111,87,95,66,86,96,94,95,102,103,82,102,100,100,120,77,95,108,93,103,93,120,100,92,92,89,115,76,111,113,102,120,104,98,93,97,120,106,123,83,87,114,123,64,89,105,86,100,105,106,78,89,113,113,83,103,97,108,102,89,92,80,88,85,97,100,101,97,85,106,106,100,131,-99,90,78,99,87,124,112,112,79,85,111,89,83,81,116,113,101,113,82,103,92,111,113,67,107,106,113,104,97,111,103,103,87,64,95,84,104,93,100,127,119,78,115,95,108,109,97,73,116,74,96,109,72,122,111,98,99,103,105,100,102,109,94,79,100,122,93,115,117,106,124,97,91,114,85,83,109,97,100,112,95,85,79,112,96,103,88,117,137,78,111,87,69,112,109,90,111,98,94,102,92,108,102,90,106,87,91,99.8232576822008,99.1994307931569,100.793655065158,98.7142321016784,100.447084571245,100.932283262723,100.239142274897,100.793655065158,100.516398670027,100.100514077331,99.8232576822008,100.862969163941,101.140225559071,100.516398670027,101.348167855419,99.9618858797662,97.6745206199385,101.209539657854,99.1994307931569,100.169828176114,101.833366546898,101.209539657854,100.58571276881,100.031199978549,99.1994307931569,101.278853756637,100.308456373679,101.001597361506,98.9221743980263,101.070911460289,99.4073730895049,99.7539435834182,100.377770472462,100.169828176114,97.1200078296773,101.417481954202,100.308456373679,99.1301166943743,100.100514077331,100.655026867593,100.655026867593,99.6153153858529,100.862969163941,98.991488496809,99.9618858797662,100.516398670027,99.4073730895049,101.694738349333,101.417481954202,101.764052448115,100.447084571245,101.417481954202,100.724340966375,101.348167855419,98.3676616077651,100.308456373679,100.655026867593,99.0608025955916,98.991488496809,100.239142274897,101.764052448115,100.932283262723,100.58571276881,99.1301166943743,100.932283262723,100.655026867593,99.4073730895049,100.031199978549,99.8925717809835,101.971994744463,99.5460012870702,101.764052448115,100.724340966375,99.9618858797662,101.001597361506,101.62542425055,99.6153153858529,101.001597361506,100.516398670027,100.100514077331,100.862969163941,99.3380589907223,101.001597361506,100.516398670027,100.58571276881,99.1994307931569,99.8232576822008,99.6846294846355,101.62542425055,99.8925717809835,99.4766871882876,98.783546200461,-99,100.308456373679,100.793655065158,101.140225559071,101.140225559071,100.377770472462,99.5460012870702,100.308456373679,70,121,100,106,87,104,97,85,106,98,102,91,93,90,109,99,80,102,88,106,111,91,101,97,98,113,111,126,100,82,95,98,78,88,122,95,126,117,113,109,64,120,123,100,87,97,136,83,113,109,93,96,97,74,94,94,107,114,116,91,99,124,88,36,113,97,110,102,115,124,123,67,111,79,103,96,90,100,95,135,76,100,110,98,98,96,90,76,96,140,96,109,-99,96,88,102,86,104,110,106)
)
```

```{r question_a3, exercise=TRUE,exercise.lines = 10}


ggplot(IQ.data,aes(x = matricesIQscore)) +
  geom_density() +
  xlab("IQ Score") +
  ylab("Density of total IQ Scores") +
  ggtitle("Distribution of IQ Scores of the Sample")
```

```{r question_a3-hint-1}
Use the `filter()` function to remove participants.
```

```{r question_a3-hint-2}
To filter out participants of a certain variable, you will need to use the 'not equal to' operator: `!=`.
```

```{r question_a3-solution}
IQ.plot_data <- filter(IQ.data,matricesIQscore != -99)

ggplot(IQ.plot_data,aes(x = matricesIQscore)) +
  geom_density() +
  xlab("IQ Score") +
  ylab("Density of total IQ Scores") +
  ggtitle("Distribution of IQ Scores of the Sample")
```

### Question A3 - Facets

Up to now, we have tended to suggest using different aesthetics to represent different variables. Another way is to split your graph into different facets (i.e., subplots). This is particularly useful for categorical variables.

To facet your graph by a single variable, add `facet_wrap()` to your plot. The first argument of this function is the name of the variable you wish to split on. The variable name is preceded by the `~` symbol. This variable should be categorical for best results.

Below is an example of a scatterplot between the a car's engine displacement (in litres) and its fuel-efficiency driving on a motorway. We have split the plot by the type of car.

```{r,echo = TRUE,eval = FALSE}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_wrap(~ class)
```

Note, you can also specify the number of rows and columns by adjusting the 'nrow' or 'ncol' arguments respectively.

Below, using the `facet_wrap()` function, split the IQ data by country.

```{r question_a4-setup, include = FALSE}
IQ.data <- data.frame(ID = 1:500,
                      country = c(rep("UK",100),rep("France",100),rep("Germany",100),rep("Italy",100),rep("Spain",100)),
                      matricesIQscore = c(83,107,93,111,94,95,98,85,90,119,90,97,115,85,127,93,90,89,83,112,113,114,68,89,137,95,109,99,93,124,111,98,80,119,93,113,76,110,113,113,85,94,74,82,107,105,88,119,91,98,102,101,86,120,102,96,73,94,-99,91,77,129,86,102,115,80,103,80,143,116,91,93,99,102,89,-99,115,100,86,90,85,103,116,104,113,-99,86,78,92,81,87,93,82,99,101,93,85,103,102,101,86,96,105,107,106,117,127,103,113,105,80,117,101,136,99,95,120,103,103,117,111,87,95,66,86,96,94,95,102,103,82,102,100,100,120,77,95,108,93,103,93,120,100,92,92,89,115,76,111,113,102,120,104,98,93,97,120,106,123,83,87,114,123,64,89,105,86,100,105,106,78,89,113,113,83,103,97,108,102,89,92,80,88,85,97,100,101,97,85,106,106,100,131,-99,90,78,99,87,124,112,112,79,85,111,89,83,81,116,113,101,113,82,103,92,111,113,67,107,106,113,104,97,111,103,103,87,64,95,84,104,93,100,127,119,78,115,95,108,109,97,73,116,74,96,109,72,122,111,98,99,103,105,100,102,109,94,79,100,122,93,115,117,106,124,97,91,114,85,83,109,97,100,112,95,85,79,112,96,103,88,117,137,78,111,87,69,112,109,90,111,98,94,102,92,108,102,90,106,87,91,99.8232576822008,99.1994307931569,100.793655065158,98.7142321016784,100.447084571245,100.932283262723,100.239142274897,100.793655065158,100.516398670027,100.100514077331,99.8232576822008,100.862969163941,101.140225559071,100.516398670027,101.348167855419,99.9618858797662,97.6745206199385,101.209539657854,99.1994307931569,100.169828176114,101.833366546898,101.209539657854,100.58571276881,100.031199978549,99.1994307931569,101.278853756637,100.308456373679,101.001597361506,98.9221743980263,101.070911460289,99.4073730895049,99.7539435834182,100.377770472462,100.169828176114,97.1200078296773,101.417481954202,100.308456373679,99.1301166943743,100.100514077331,100.655026867593,100.655026867593,99.6153153858529,100.862969163941,98.991488496809,99.9618858797662,100.516398670027,99.4073730895049,101.694738349333,101.417481954202,101.764052448115,100.447084571245,101.417481954202,100.724340966375,101.348167855419,98.3676616077651,100.308456373679,100.655026867593,99.0608025955916,98.991488496809,100.239142274897,101.764052448115,100.932283262723,100.58571276881,99.1301166943743,100.932283262723,100.655026867593,99.4073730895049,100.031199978549,99.8925717809835,101.971994744463,99.5460012870702,101.764052448115,100.724340966375,99.9618858797662,101.001597361506,101.62542425055,99.6153153858529,101.001597361506,100.516398670027,100.100514077331,100.862969163941,99.3380589907223,101.001597361506,100.516398670027,100.58571276881,99.1994307931569,99.8232576822008,99.6846294846355,101.62542425055,99.8925717809835,99.4766871882876,98.783546200461,-99,100.308456373679,100.793655065158,101.140225559071,101.140225559071,100.377770472462,99.5460012870702,100.308456373679,70,121,100,106,87,104,97,85,106,98,102,91,93,90,109,99,80,102,88,106,111,91,101,97,98,113,111,126,100,82,95,98,78,88,122,95,126,117,113,109,64,120,123,100,87,97,136,83,113,109,93,96,97,74,94,94,107,114,116,91,99,124,88,36,113,97,110,102,115,124,123,67,111,79,103,96,90,100,95,135,76,100,110,98,98,96,90,76,96,140,96,109,-99,96,88,102,86,104,110,106)
)
```

```{r question_a4, exercise=TRUE,exercise.lines = 10}
IQ.plot_data <- filter(IQ.data,matricesIQscore != -99)

ggplot(IQ.plot_data,aes(x = matricesIQscore)) +
  geom_density() +
  xlab("IQ Score") +
  ylab("Density of total IQ Scores") +
  ggtitle("Distribution of IQ Scores of the Sample")
```

```{r question_a4-hint-1}
Add the `facet_wrap()` function to your plot using the `+` symbol.
Remember to precede the variable name with the `~` symbol.
```

```{r question_a4-hint-2}
You can specify a certain number of rows/columns, but it's not necessary here.
```

```{r question_a4-solution}
#Remember you can call the data.frame if you need to see the variable names.

IQ.plot_data <- filter(IQ.data,matricesIQscore != -99)

ggplot(IQ.plot_data,aes(x = matricesIQscore)) +
  geom_density() +
  xlab("IQ Score") +
  ylab("Density of total IQ Scores") +
  ggtitle("Distribution of IQ Scores of the Sample") +
  facet_wrap(~ country)
```

### Question A4 - Data Diagnostics 2

Looking at the distributions split by country, does anything look odd to you?

It is unlikely that IQ scores from Italian participants to have such a drastically different distribution compared to the rest of the population. Perhaps there was an error in coding this data?

After reviewing the data cleaning scripts, you discover that your collaborator in Italy adjusted the IQ scores so that the standard deviation for the sample equalled 1. The standard deviation for IQ scores should be 15.

In the box below, mutate the data to fix this mistake, then replot the data. Note: this is a particularly tricky question!

```{r question_a5-setup, include = FALSE}
IQ.data <- data.frame(ID = 1:500,
                      country = c(rep("UK",100),rep("France",100),rep("Germany",100),rep("Italy",100),rep("Spain",100)),
                      matricesIQscore = c(83,107,93,111,94,95,98,85,90,119,90,97,115,85,127,93,90,89,83,112,113,114,68,89,137,95,109,99,93,124,111,98,80,119,93,113,76,110,113,113,85,94,74,82,107,105,88,119,91,98,102,101,86,120,102,96,73,94,-99,91,77,129,86,102,115,80,103,80,143,116,91,93,99,102,89,-99,115,100,86,90,85,103,116,104,113,-99,86,78,92,81,87,93,82,99,101,93,85,103,102,101,86,96,105,107,106,117,127,103,113,105,80,117,101,136,99,95,120,103,103,117,111,87,95,66,86,96,94,95,102,103,82,102,100,100,120,77,95,108,93,103,93,120,100,92,92,89,115,76,111,113,102,120,104,98,93,97,120,106,123,83,87,114,123,64,89,105,86,100,105,106,78,89,113,113,83,103,97,108,102,89,92,80,88,85,97,100,101,97,85,106,106,100,131,-99,90,78,99,87,124,112,112,79,85,111,89,83,81,116,113,101,113,82,103,92,111,113,67,107,106,113,104,97,111,103,103,87,64,95,84,104,93,100,127,119,78,115,95,108,109,97,73,116,74,96,109,72,122,111,98,99,103,105,100,102,109,94,79,100,122,93,115,117,106,124,97,91,114,85,83,109,97,100,112,95,85,79,112,96,103,88,117,137,78,111,87,69,112,109,90,111,98,94,102,92,108,102,90,106,87,91,99.8232576822008,99.1994307931569,100.793655065158,98.7142321016784,100.447084571245,100.932283262723,100.239142274897,100.793655065158,100.516398670027,100.100514077331,99.8232576822008,100.862969163941,101.140225559071,100.516398670027,101.348167855419,99.9618858797662,97.6745206199385,101.209539657854,99.1994307931569,100.169828176114,101.833366546898,101.209539657854,100.58571276881,100.031199978549,99.1994307931569,101.278853756637,100.308456373679,101.001597361506,98.9221743980263,101.070911460289,99.4073730895049,99.7539435834182,100.377770472462,100.169828176114,97.1200078296773,101.417481954202,100.308456373679,99.1301166943743,100.100514077331,100.655026867593,100.655026867593,99.6153153858529,100.862969163941,98.991488496809,99.9618858797662,100.516398670027,99.4073730895049,101.694738349333,101.417481954202,101.764052448115,100.447084571245,101.417481954202,100.724340966375,101.348167855419,98.3676616077651,100.308456373679,100.655026867593,99.0608025955916,98.991488496809,100.239142274897,101.764052448115,100.932283262723,100.58571276881,99.1301166943743,100.932283262723,100.655026867593,99.4073730895049,100.031199978549,99.8925717809835,101.971994744463,99.5460012870702,101.764052448115,100.724340966375,99.9618858797662,101.001597361506,101.62542425055,99.6153153858529,101.001597361506,100.516398670027,100.100514077331,100.862969163941,99.3380589907223,101.001597361506,100.516398670027,100.58571276881,99.1994307931569,99.8232576822008,99.6846294846355,101.62542425055,99.8925717809835,99.4766871882876,98.783546200461,-99,100.308456373679,100.793655065158,101.140225559071,101.140225559071,100.377770472462,99.5460012870702,100.308456373679,70,121,100,106,87,104,97,85,106,98,102,91,93,90,109,99,80,102,88,106,111,91,101,97,98,113,111,126,100,82,95,98,78,88,122,95,126,117,113,109,64,120,123,100,87,97,136,83,113,109,93,96,97,74,94,94,107,114,116,91,99,124,88,36,113,97,110,102,115,124,123,67,111,79,103,96,90,100,95,135,76,100,110,98,98,96,90,76,96,140,96,109,-99,96,88,102,86,104,110,106)
)
```

```{r question_a5, exercise=TRUE,exercise.lines = 15}
IQ.plot_data <- filter(IQ.data,matricesIQscore != -99)

ggplot(IQ.plot_data,aes(x = matricesIQscore)) +
  geom_density() +
  xlab("IQ Score") +
  ylab("Density of total IQ Scores") +
  ggtitle("Distribution of IQ Scores of the Sample") +
  facet_wrap(~ country)
```

```{r question_a5-hint-1}
Use the `mutate()` function to edit values in a data.frame.
You may also want to use the `ifelse()` function.
If you're unsure how this function works, try looking on Google, or type `help(ifelse)` into the console.
```

```{r question_a5-hint-2}
To fix this mistake, you will need to do the following:
1. Centre IQ scores for participants from Italy.
2. Multiply IQ scores by the correct standard deviation (15).
3. Re-centre the IQ scores to the current mean.
```

```{r question_a5-solution}
#Get mean for Italian participants
filter(IQ.data,matricesIQscore != -99) %>%
  group_by(country) %>%
  summarise(m = mean(matricesIQscore))

#Mean for Italian participants = 98.9

#Below we use the ifelse() function. How to read this is: if country is exactly equal to Italy, perform operation, otherwise, leave matricesIQscore alone.

IQ.plot_data <- filter(IQ.data,matricesIQscore != -99) %>%
  mutate(matricesIQscore = ifelse(country == "Italy",((matricesIQscore - 98.9) * 15) + 98.9,matricesIQscore))

ggplot(IQ.plot_data,aes(x = matricesIQscore)) +
  geom_density() +
  xlab("IQ Score") +
  ylab("Density of total IQ Scores") +
  ggtitle("Distribution of IQ Scores of the Sample") +
  facet_wrap(~ country)
```