---
title: "Exercise 6"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
library(tidyverse)
library(lm.beta)
knitr::opts_chunk$set(echo = FALSE)

checker <- function(label,user_code,solution_code,check_code,envir_result,evaluate_result,envir_prep,...){
  
  envir_result
  out <- list(message = sample(c("Good Job!",
                                 "Well done!",
                                 "Great stuff!",
                                 "That is correct!",
                                 "Correct! You are really good at this."),1), correct = TRUE, location = "append")

#Question 1  
if(label == "question_1"){
	
	correct_cor.data <- data.frame(var1 = c(0.73,0.05,0.94,0.19,-0.99,-0.53,-0.37,1.17,0.44,0.23,0.27,0.31,-0.76,-1.21,0.75,-0.6,0.07,-0.19,0.71,1.42,1.15,0.6,1.71,0.71,-0.44,-0.29,-0.22,0.62,1.39,0.26,-0.55,1.15,-1.28,-0.44,-0.13,0.57,1.4,-0.64,2.81,1.35,0.7,1.39,-0.09,0.98,-1.05,-0.52,1.11,-2.02,2.25,0.66,-1.52,-1.64,0.58,-0.09,2.27,-0.52,-0.18,-0.52,0.47,-2.01),
	var2 = c(0.03,-0.21,-0.08,-2.44,-0.45,-0.94,-1.23,0.78,0.58,1.98,0.14,0.67,0.62,-0.51,1.1,-0.25,-1.07,0.41,-0.94,0.21,0.05,-0.82,-1.3,-1.61,-1,-1.34,1.22,-0.32,-1.74,-0.08,-0.85,1.39,-1.22,-0.32,2.09,0.09,1.11,0.63,0.5,0.76,1.39,1.49,0.48,0.21,-1.43,0.13,0.72,-2.38,1.59,-0.52,-0.57,-0.81,-0.62,-0.93,0.98,1.18,0.46,-0.66,-0.92,0.13))
	
	correct_cor.result <- cor.test(~ var1 + var2,correct_cor.data)
	
	if(!exists("cor.data")){
		out <- list(message = "The data appears to be altered. Do not alter the data.frame saved as `cor.data`. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
	} else {
		if(!identical(cor.data,correct_cor.data)){
			out <- list(message = "The data appears to be altered. Do not alter the data.frame saved as `cor.data`. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
		} else {
			if(!exists("cor.result")){
				out <- list(message = "There is no object saved as `cor.result`. Save the correlation output as this object.", correct = FALSE, location = "append")
			} else {
				if(class(cor.result) != "htest"){
					out <- list(message = "The object saved as `cor.result` does not appear to be output from a correlation.", correct = FALSE, location = "append")
				} else {
					if(cor.result$estimate != correct_cor.result$estimate){
						out <- list(message = "The correlation output does not match the correct answer. Please check there are no errors in the code. A common mistake is to not have calculated the mean pain across 5 days correctly.", correct = FALSE, location = "append")
					}
				}
			}
		}
	}
}
  
#Question 3
if(label == "question_3"){
	
	correct_pain.data <- data.frame(pain1 = c(1,3,4,3,5,5,2,4,3,2,3,5,1,3,2,2,2,1,4,3,3,2,4,1,3,1,2,4,1,3,4,1,4,3,5,2,4,4,1,1,5,2,3,5,1,1,5,4,1,5,5,3,2,2,2,3,1,5,2,5),
	pain2 = c(1,4,2,3,4,5,3,3,2,1,5,1,1,5,1,2,3,5,3,4,3,2,2,4,1,5,5,4,2,4,3,1,1,3,1,3,5,1,2,4,2,4,4,1,1,2,3,5,5,3,2,3,1,1,5,5,1,3,3,5),
	pain3 = c(1,4,4,5,3,1,4,5,3,4,5,2,3,2,1,4,4,5,5,1,3,5,1,2,3,4,3,4,2,3,3,5,2,2,2,3,5,4,5,2,2,4,1,3,4,4,5,2,2,3,3,3,1,4,2,2,2,4,4,1),
	pain4 = c(1,4,2,4,4,2,5,5,2,3,5,2,2,5,2,4,4,2,3,1,4,3,5,2,1,1,4,3,2,3,1,1,2,1,2,1,2,5,1,3,1,3,1,4,3,2,2,2,5,3,4,5,2,1,4,4,1,2,4,1),
	pain5 = c(4,4,5,1,5,3,1,5,5,3,4,1,2,4,4,4,3,5,5,1,4,3,4,1,5,3,3,2,4,4,1,3,4,1,2,5,3,5,2,3,1,3,3,2,1,4,1,5,5,1,5,2,2,3,3,5,2,3,3,2),
	social_support = c(3,4,8,1,1,8,4,3,8,6,4,6,5,5,2,4,2,4,4,1,3,3,7,6,2,1,4,8,7,7,7,5,6,7,2,4,1,9,7,7,3,7,6,3,2,6,8,1,9,1,8,8,9,3,1,5,3,1,2,6))
	
	temp.data <- mutate(correct_pain.data,pain_mean = (pain1 + pain2 + pain3 + pain4 + pain5)/5)
	
	correct_pain.cor <- cor.test(~ pain_mean + social_support,temp.data)
	
	if(!exists("pain.data")){
		out <- list(message = "The data appears to be altered. Do not alter the data.frame saved as `pain.data`. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
	} else {
		if(!identical(pain.data,correct_pain.data)){
			out <- list(message = "The data appears to be altered. Do not alter the data.frame saved as `pain.data`. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
		} else {
			if(!exists("pain.cor")){
				out <- list(message = "There is no object saved as `pain.cor`. Save the correlation output as this object.", correct = FALSE, location = "append")
			} else {
				if(class(pain.cor) != "htest"){
					out <- list(message = "The object saved as `pain.result` does not appear to be output from a correlation.", correct = FALSE, location = "append")
				} else {
					if(pain.cor$estimate != correct_pain.cor$estimate){
						out <- list(message = "The correlation output does not match the correct answer. Please check there are no errors in the code.", correct = FALSE, location = "append")
					}
				}
			}
		}
	}
}

#Question 4
if (label == "question_4"){
	correct_lm.data <- data.frame(DV = c(0.94,0.51,0.72,-0.27,1.76,1.72,1.85,-1.21,0.5,0.16,-0.45,-0.31,-0.3,-0.63,-0.03,-0.94,0.21,-0.04,0.14,0.11,2.06,-0.02,-1.6,-0.03,0.23,0.47,-0.16,0.26,1.08,-0.1,-1.38,-0.77,1.05,0.73,0.55,-0.5,-0.95,2.01,-1.14,-0.45,-1.25,-0.99,0.25,-1.82,0.88,0.15,-0.71,-0.24,0.02,0.15,-0.72,0.34,-0.79,2.83,1.05,-0.32,-0.27,0.63,0.37,0.07),
	IV1 = c(-0.18,-0.13,0.6,-0.36,0.36,0.05,0.25,-0.03,0.13,0.5,0.19,0.4,0.3,-0.22,0.19,-0.73,1.29,0.06,0.11,0.02,-0.51,0.05,0.45,-0.77,-1.05,0.18,0.22,0.28,0.24,-0.6,-0.34,-0.8,1,-0.5,0.43,0.18,0.07,0.26,-0.62,1.08,-0.3,-0.56,-0.17,-0.04,-0.33,0,-0.31,0.35,0.63,-0.1,-0.34,-0.5,0.43,-0.18,-0.25,-0.62,0.28,-0.22,-0.06,-0.17),
	IV2 = c(0.05,-0.12,-0.65,-0.18,-0.19,-0.03,-0.97,0.44,-0.19,-0.35,0.44,-0.65,-0.01,-0.99,0.48,-0.18,0.59,-0.73,0.1,0.59,0.44,-0.24,-0.06,-0.28,-0.22,0.17,-0.2,0.52,0.05,0.04,-0.06,0.14,-0.2,0.59,-0.65,-1.15,0.14,0.87,-0.54,0.4,-0.1,-0.12,0.24,-0.34,0.22,-0.26,0.77,0.04,0.05,-0.22,-0.48,0.56,0.77,0.55,0.37,-0.04,0.7,0.11,0.36,-0.46))
	
	correct_lm.summary <- lm(DV ~ IV1 + IV2,data = correct_lm.data) %>% summary()
	
	if(!exists("lm.data")){
		out <- list(message = "The data appears to be altered. Do not alter the data.frame saved as `lm.data`. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
	} else {
		if(!identical(lm.data,correct_lm.data)){
			out <- list(message = "The data appears to be altered. Do not alter the data.frame saved as `lm.data`. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
		} else {
			if(!exists("lm.summary")){
				out <- list(message = "There is no object saved as `lm.summary`. Save the regression output as this object.", correct = FALSE, location = "append")
			} else {
				if(class(lm.summary) != "summary.lm"){
					out <- list(message = "The object saved as `lm.summary` is not the output of a regression. Remember to use the `summary()` function.", correct = FALSE, location = "append")
				} else {
					if(!("IV2" %in% rownames(lm.summary$coefficients))){
						out <- list(message = "The additional predictor of `IV2` was not detected in the regression output. Make sure to add this variable in the formula within the `lm()` function.", correct = FALSE, location = "append")
					} else {
						if(round(lm.summary$coefficients["IV2","Estimate"],2) != round(correct_lm.summary$coefficients["IV2","Estimate"],2)){
							out <- list(message = "There appears to be an error in the output. The estimate for `IV2` is not correct. Please check for errors in the code.", correct = FALSE, location = "append")
						}
					}
				}
			}
		}
	}	
}

#Question 5
if(label == "question_5"){
	
	correct_CA.data <- data.frame(ID = 1:60,
	SDO = c(96,19,83,92,90,104,54,50,109,89,108,102,109,30,26,100,82,74,70,85,47,84,52,45,53,101,41,68,63,33,32,41,72,39,63,83,69,82,68,112,111,76,63,40,21,23,63,54,73,73,81,57,58,66,74,20,99,82,60,18),
	HS = c(65,41,24,61,42,62,19,72,66,42,60,15,11,58,72,65,46,33,20,14,19,71,60,60,60,54,39,16,48,39,62,14,64,33,30,40,57,40,50,11,55,52,38,14,68,50,65,49,54,14,25,68,25,23,43,14,28,74,57,44),
	BS = c(37,41,65,59,48,16,19,20,46,52,35,21,42,48,12,70,71,40,50,67,67,58,19,36,43,68,60,70,33,26,60,52,59,36,56,25,21,54,57,73,25,21,54,61,24,45,44,51,43,59,39,56,55,38,40,21,40,33,45,31),
	e = c(0.24,0.08,0.08,-0.16,-0.07,-0.16,-0.15,-0.05,-0.21,0.24,0.19,-0.3,0.11,-0.37,-0.22,-0.33,0.07,-0.36,-0.01,-0.13,-0.36,-0.15,0.2,0.55,-0.21,-0.09,-0.17,0.19,-0.2,-0.22,-0.01,-0.07,-0.34,-0.01,0.21,0,0.11,0.13,0.02,0.46,0.07,0.06,-0.37,0.41,-0.3,0.22,-0.39,-0.01,-0.19,0.01,0.26,0.14,-0.14,-0.05,0.37,-0.1,-0.02,0.13,-0.1,0)) %>%
	mutate(CA = scale(.3*SDO + .1*HS + .05*BS) %>% round(2) + e) %>%
	select(-e)
	
	correct_CA.summary <- lm(CA ~ SDO + HS + BS,data = correct_CA.data) %>% summary()
	
	if(!exists("CA.data")){
		out <- list(message = "The data appears to be altered. Do not alter the data.frame saved as `CA.data`. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
	} else {
		if(!identical(CA.data,correct_CA.data)){
			out <- list(message = "The data appears to be altered. Do not alter the data.frame saved as `CA.data`. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
		} else {
			if(!exists("CA.summary")){
				out <- list(message = "There is no object saved as `CA.summary`. Save the regression output as this object.", correct = FALSE, location = "append")
			} else {
				if(class(CA.summary) != "summary.lm"){
					out <- list(message = "The object saved as `CA.summary` is not the output of a regression. Remember to use the `summary()` function.", correct = FALSE, location = "append")
				} else {
					if(!("SDO" %in% rownames(CA.summary$coefficients)) |
						!("HS" %in% rownames(CA.summary$coefficients)) |
						!("BS" %in% rownames(CA.summary$coefficients))){
						out <- list(message = "The regression output saved as `CA.summary` does not appear to have all the relevant predictors. Make sure that all relevant predictors are included in the model.", correct = FALSE, location = "append")
					} else {
						if(round(CA.summary$coefficients["SDO","Estimate"],2) != round(correct_CA.summary$coefficients["SDO","Estimate"],2)){
							out <- list(message = "There appears to be an error in the output. The estimates in the model do not match the correct answer. Please check for errors in the code.", correct = FALSE, location = "append")
						}
					}
				}
			}
		}
	}
	
}

#Question 8
if(label == "question_8"){

correct_memory.data <- data.frame(ID = 1:34,
	age = c(26,30,22,23,29,32,25,26,21,18,27,26,31,27,25,25,18,32,18,27,22,32,18,29,34,31,30,22,34,22,18,21,34,21),
	condition = c(0.5,0.5,-0.5,-0.5,0.5,-0.5,-0.5,-0.5,-0.5,-0.5,-0.5,0.5,0.5,0.5,0.5,0.5,0.5,-0.5,-0.5,-0.5,-0.5,0.5,-0.5,-0.5,-0.5,0.5,-0.5,-0.5,-0.5,0.5,0.5,0.5,-0.5,-0.5),
	e = c(782.6,343.5,204.2,1263.4,284.8,1032.8,-143.9,410.9,506.9,-100,162.7,1066.1,-166.1,737.8,847.6,464.8,1197.5,550.9,968.6,535.4,675,1484.1,224.4,1259.6,-96.9,750.1,502.6,913.4,186.3,315.3,669.8,598.6,765.2,324.9)) %>%
	mutate(recall = abs(e) + 10*(age-25.76) + .2*condition) %>%
	select(-e)

correct_memory.lm <- lm(recall ~ condition + age,data = correct_memory.data)

correct_memory.summary <- summary(correct_memory.lm)

correct_memory.beta <- lm.beta(correct_memory.lm)

	if(!exists("memory.data")){
			out <- list(message = "The data appears to be altered. Do not alter the data.frame saved as `memory.data`. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
	} else {
		if(!identical(memory.data,correct_memory.data)){
			out <- list(message = "The data appears to be altered. Do not alter the data.frame saved as `memory.data`. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
		} else {
			if(!exists("memory.summary")){
				out <- list(message = "There is no object saved as `memory.summary`. Save the regression output as this object.", correct = FALSE, location = "append")
			} else {
				if(class(memory.summary) != "summary.lm"){
					out <- list(message = "The object saved as `memory.summary` is not the output of a regression. Remember to use the `summary()` function.", correct = FALSE, location = "append")
				} else {
					if(!("condition" %in% rownames(memory.summary$coefficients))){
						out <- list(message = "The predictor `condition` was not detected in the regression output. Make sure to add this variable in the formula within the `lm()` function.", correct = FALSE, location = "append")
					} else {
						if(!("age" %in% rownames(memory.summary$coefficients))){
							out <- list(message = "Age does not appear to be controlled for in the model. Make sure to add this variable in the formula within the `lm()` function.", correct = FALSE, location = "append")
						} else {
							if(round(memory.summary$coefficients["age","Estimate"],2) != round(correct_memory.summary$coefficients["age","Estimate"],2)){
								out <- list(message = "There appears to be an error in the output saved as `memory.summary`. The estimates in the model do not match the correct answer. Make sure this is the unstandardised linear regression.", correct = FALSE, location = "append")
							} else {
								if(!exists("memory.beta")){
									out <- list(message = "There is no object saved as `memory.beta`. Save the output from the `lm.beta()` function as this object.", correct = FALSE, location = "append")
								} else {
									if(!("age" %in% names(memory.beta$standardized.coefficients)) | !("condition" %in% names(memory.beta$standardized.coefficients))){
										out <- list(message = "The standardised variables do not match that of the original linear regression. Check there are no errors in the code.", correct = FALSE, location = "append")
									} else {
										if(round(memory.beta$standardized.coefficients["age"],2) != round(correct_memory.beta$standardized.coefficients["age"],2)){
										out <- list(message = "There appears to be an error in the standardised coefficients saved as `memory.beta`. The estimates in the model do not match the correct answer. Check there are no errors in the code.", correct = FALSE, location = "append")
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
}

if(label == "question_4.1"){
	correct_numbers <- numbers <- c(73,77,86,81,75,83,89,121,104,77,113,104,97,107,99,110,103,84,103,99,95,93,113,83,103,92,92,107,111,103,104,110,109,102,96,88,108,101,92,86)
	
	correct_z.numbers <- (correct_numbers - 96.825)/11.96766
	if(!exists("numbers")){
		out <- list(message = "The object `numbers` appears to be altered. Do not alter this object. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
	} else {
		if(!identical(numbers,correct_numbers)){
			out <- list(message = "The object `numbers` appears to be altered. Do not alter this object. Click the 'Start Over' button if necessary.", correct = FALSE, location = "append")
		} else {
			if(!exists("z.numbers")){
				out <- list(message = "There is no object saved as `z.numbers`. Make sure to save the standardised vector as this.", correct = FALSE, location = "append")
			} else {
				if(round(z.numbers[1],2) != round(correct_z.numbers[1],2)){
					out <- list(message = "There object saved as `z.numbers` does not match the correct answer. Check there are no errors in the code.", correct = FALSE, location = "append")
				}
			}
		}
	}
}  
            
return(out)
}

tutorial_options(exercise.checker = checker)
```

## Introduction

This is the sixth of the weekly exercises. These exercises are designed to reinforce content taught each week. Typically, they consist of quiz questions and R exercises that require you to enter code into a box. These exercises are split into beginner and advance sections. It is expected that students can complete the beginner sections of each weekly exercise, with the advanced sections designed for students who want an extra challenge or learn additional functions in R.If you are struggling, each exercise comes with a number of hints that may be helpful.

## Basic Exercises

### Question 1

There is an error in the code below. Fix the code so that it runs a correlation between var1 and var2 from the `cor.data` data.frame. Save the correlation output to an object called `cor.result`.

```{r question_1-setup}
cor.data <- data.frame(var1 = c(0.73,0.05,0.94,0.19,-0.99,-0.53,-0.37,1.17,0.44,0.23,0.27,0.31,-0.76,-1.21,0.75,-0.6,0.07,-0.19,0.71,1.42,1.15,0.6,1.71,0.71,-0.44,-0.29,-0.22,0.62,1.39,0.26,-0.55,1.15,-1.28,-0.44,-0.13,0.57,1.4,-0.64,2.81,1.35,0.7,1.39,-0.09,0.98,-1.05,-0.52,1.11,-2.02,2.25,0.66,-1.52,-1.64,0.58,-0.09,2.27,-0.52,-0.18,-0.52,0.47,-2.01),
	var2 = c(0.03,-0.21,-0.08,-2.44,-0.45,-0.94,-1.23,0.78,0.58,1.98,0.14,0.67,0.62,-0.51,1.1,-0.25,-1.07,0.41,-0.94,0.21,0.05,-0.82,-1.3,-1.61,-1,-1.34,1.22,-0.32,-1.74,-0.08,-0.85,1.39,-1.22,-0.32,2.09,0.09,1.11,0.63,0.5,0.76,1.39,1.49,0.48,0.21,-1.43,0.13,0.72,-2.38,1.59,-0.52,-0.57,-0.81,-0.62,-0.93,0.98,1.18,0.46,-0.66,-0.92,0.13))
```

```{r question_1, exercise=TRUE,exercise.lines = 5}
cor.result <- cor.test(var1 ~ var2,data = cor.data)

cor.result
```

```{r question_1-hint-1}
When running the incorrect code, what does the error message say?
```

```{r question_1-hint-2}
Correlations cannot infer causality... this may be reflected in the formula...

Next hint will show the solution...
```

```{r question_1-solution}
#Notice the formula difference.
cor.result <- cor.test(~ var1 + var2,data = cor.data)

cor.result
```

```{r question_1-check}
checker()
```

### Question 2

You have measured the dark triad traits in 40 participants. This data is saved in a data.frame called `darktriad.data`. Which two of the three traits has the largest, positive correlation?

```{r question_2-setup}
darktriad.data <- data.frame(ID = 1:40,
narcissism = c(-0.01,1.34,1.39,0.19,-1.31,-0.83,-0.36,0.02,-0.38,-0.42,-1.6,1.63,1.35,-0.97,0.98,-0.54,-0.26,-0.37,-0.23,0.82,-0.77,0.31,-0.31,-0.67,-0.25,-1.78,0.34,-0.45,-0.38,0.24,0.12,0.98,-1.04,0.89,1.18,-0.54,-0.05,-0.69,-0.28,-0.55),
machiavellianism = c(1.1,-0.97,-0.8,-0.18,-0.56,0.1,-0.8,0.3,1.43,0.49,-0.79,0,0.03,-0.09,-0.94,-2.51,2.29,-0.21,-0.45,-0.03,-1.08,0.34,-0.59,0.43,0.1,1.56,0.63,0.36,0.58,-0.69,-1.75,0.36,0.77,-0.92,-0.07,0.02,-0.4,0.63,-0.15,0.2),
psychopathy = c(0.86,2.08,-1.18,-0.66,0.09,0.25,-0.92,-1.05,0.92,1.52,0.74,0.72,2.21,1.76,-0.59,-0.67,1.86,0.6,1.7,1.46,0.91,-0.28,-0.38,1.13,-0.12,-0.43,1.66,0.25,1.8,0.13,-0.85,-1.27,-1,-0.2,0.76,0.35,-1.56,-0.93,0.8,-1.05))
```

```{r question_2, exercise=TRUE,exercise.lines = 8}
darktriad.data
```

```{r question_2-hint-1}
You may need to conduct multiple correlations.
```

```{r question_2-hint-2}
Use the following code template to run a correlation between each pair of variables.

cor.test(~ variable1 + variable2,data = data.frame)

Next hint will show the solution...
```

```{r question_2-solution}
cor.test(~ narcissism + machiavellianism,data = darktriad.data)

cor.test(~ narcissism + psychopathy,data = darktriad.data)

cor.test(~ machiavellianism + psychopathy,data = darktriad.data)
```

```{r question_2-quiz}
quiz(question("Which two traits have the largest, positive correlation?",
              answer("Narcissism and Machiavellianism"),
              answer("Narcissism and Psychopathy"),
              answer("Machiavellianism and Psychopathy",correct = TRUE),
              answer("They all have the same correlation"),allow_retry = TRUE))
```

### Question 3

In the data.frame `pain.data`, you've asked participants to rate (on a 5-point scale) how much chronic pain they experience across 5 days. Compute a mean pain rating across the 5 days and test whether this correlates with level of social support. Save the correlation output as `pain.cor`.

```{r question_3-setup}
pain.data <- data.frame(pain1 = c(1,3,4,3,5,5,2,4,3,2,3,5,1,3,2,2,2,1,4,3,3,2,4,1,3,1,2,4,1,3,4,1,4,3,5,2,4,4,1,1,5,2,3,5,1,1,5,4,1,5,5,3,2,2,2,3,1,5,2,5),
	pain2 = c(1,4,2,3,4,5,3,3,2,1,5,1,1,5,1,2,3,5,3,4,3,2,2,4,1,5,5,4,2,4,3,1,1,3,1,3,5,1,2,4,2,4,4,1,1,2,3,5,5,3,2,3,1,1,5,5,1,3,3,5),
	pain3 = c(1,4,4,5,3,1,4,5,3,4,5,2,3,2,1,4,4,5,5,1,3,5,1,2,3,4,3,4,2,3,3,5,2,2,2,3,5,4,5,2,2,4,1,3,4,4,5,2,2,3,3,3,1,4,2,2,2,4,4,1),
	pain4 = c(1,4,2,4,4,2,5,5,2,3,5,2,2,5,2,4,4,2,3,1,4,3,5,2,1,1,4,3,2,3,1,1,2,1,2,1,2,5,1,3,1,3,1,4,3,2,2,2,5,3,4,5,2,1,4,4,1,2,4,1),
	pain5 = c(4,4,5,1,5,3,1,5,5,3,4,1,2,4,4,4,3,5,5,1,4,3,4,1,5,3,3,2,4,4,1,3,4,1,2,5,3,5,2,3,1,3,3,2,1,4,1,5,5,1,5,2,2,3,3,5,2,3,3,2),
	social_support = c(3,4,8,1,1,8,4,3,8,6,4,6,5,5,2,4,2,4,4,1,3,3,7,6,2,1,4,8,7,7,7,5,6,7,2,4,1,9,7,7,3,7,6,3,2,6,8,1,9,1,8,8,9,3,1,5,3,1,2,6))
```

```{r question_3, exercise=TRUE,exercise.lines = 12}
pain.data
```

```{r question_3-hint-1}
You will need to calculate the mean pain across the 5 days using a tidyverse function. Remember, the mean is the all the values added together, then divided by the number of values.
```

```{r question_3-hint-2}
You can use the following code to calculate the mean pain across the 5 ratings.

pain.data2 <- mutate(correct_pain.data,pain_mean = (pain1 + pain2 + pain3 + pain4 + pain5)/5)

Next hint will show the solution...
```

```{r question_3-solution}
pain.data

pain.data2 <- mutate(pain.data,pain_mean = (pain1 + pain2 + pain3 + pain4 + pain5)/5)

pain.cor <- cor.test(~ pain_mean + social_support,data = pain.data2)
```

```{r question_3-check}
checker()
```

### Question 4

Below is a vector of numbers. Standardise the numbers in this vector and save the result as `z.numbers`.

```{r question_4.1, exercise=TRUE,exercise.lines = 12}
numbers <- c(73,77,86,81,75,83,89,121,104,77,113,104,97,107,99,110,103,84,103,99,95,93,113,83,103,92,92,107,111,103,104,110,109,102,96,88,108,101,92,86)

z.numbers
```

```{r question_4.1-hint-1}
To standardise a list of numbers, you will need to calculate the mean and standard deviation of the numbers.
```

```{r question_4.1-hint-2}
The equation to standardise a number is to subtract the mean, then divide the standard deviation.

Next hint will show the solution...
```

```{r question_4.1-solution}
mean(numbers)
sd(numbers)

z.numbers <- (numbers - 96.825)/11.96766
```

```{r question_4.1-check}
checker()
```

### Question 5

Below is the code that runs an unstandardised linear regression between two variables from the data.frame `lm.data`. Edit the code to include a second predictor, `IV2`, to the model. Save the `summary()` output as `lm.summary`.

```{r question_4-setup}
lm.data <- data.frame(DV = c(0.94,0.51,0.72,-0.27,1.76,1.72,1.85,-1.21,0.5,0.16,-0.45,-0.31,-0.3,-0.63,-0.03,-0.94,0.21,-0.04,0.14,0.11,2.06,-0.02,-1.6,-0.03,0.23,0.47,-0.16,0.26,1.08,-0.1,-1.38,-0.77,1.05,0.73,0.55,-0.5,-0.95,2.01,-1.14,-0.45,-1.25,-0.99,0.25,-1.82,0.88,0.15,-0.71,-0.24,0.02,0.15,-0.72,0.34,-0.79,2.83,1.05,-0.32,-0.27,0.63,0.37,0.07),
	IV1 = c(-0.18,-0.13,0.6,-0.36,0.36,0.05,0.25,-0.03,0.13,0.5,0.19,0.4,0.3,-0.22,0.19,-0.73,1.29,0.06,0.11,0.02,-0.51,0.05,0.45,-0.77,-1.05,0.18,0.22,0.28,0.24,-0.6,-0.34,-0.8,1,-0.5,0.43,0.18,0.07,0.26,-0.62,1.08,-0.3,-0.56,-0.17,-0.04,-0.33,0,-0.31,0.35,0.63,-0.1,-0.34,-0.5,0.43,-0.18,-0.25,-0.62,0.28,-0.22,-0.06,-0.17),
	IV2 = c(0.05,-0.12,-0.65,-0.18,-0.19,-0.03,-0.97,0.44,-0.19,-0.35,0.44,-0.65,-0.01,-0.99,0.48,-0.18,0.59,-0.73,0.1,0.59,0.44,-0.24,-0.06,-0.28,-0.22,0.17,-0.2,0.52,0.05,0.04,-0.06,0.14,-0.2,0.59,-0.65,-1.15,0.14,0.87,-0.54,0.4,-0.1,-0.12,0.24,-0.34,0.22,-0.26,0.77,0.04,0.05,-0.22,-0.48,0.56,0.77,0.55,0.37,-0.04,0.7,0.11,0.36,-0.46))
```

```{r question_4, exercise=TRUE,exercise.lines = 6}
lm.data

lm.model <- lm(DV ~ IV1,data = lm.data)

lm.summary <- summary(lm.model)
```

```{r question_4-hint-1}
Use the `lm()` function to conduct a linear regression. If you having trouble remembering how to use this function, you can type `help(lm)` into the console, or google `how to use the lm function in R`.
```

```{r question_4-hint-2}
You can add a predictor to the linear regression by editing the formula in the `lm()` function.

Next hint will show the solution...
```

```{r question_4-solution}
lm.data

lm.model <- lm(DV ~ IV1 + IV2,data = lm.data)

lm.summary <- summary(lm.model)
```

```{r question_4-check}
checker()
```

### Question 6

You are interested in factors that predict women's engagement in collective action. You measure a number of personality traits, including Social Dominance Orientation (SDO), Hostile Sexism (HS) and Benevolent Sexism (BS). Run an unstandardised linear regression to determine the unique contribution each has on women's likelihood of engaging in collective action (CA). Save the regression output as `CA.summary`.

```{r question_5-setup}
CA.data <- data.frame(ID = 1:60,
	SDO = c(96,19,83,92,90,104,54,50,109,89,108,102,109,30,26,100,82,74,70,85,47,84,52,45,53,101,41,68,63,33,32,41,72,39,63,83,69,82,68,112,111,76,63,40,21,23,63,54,73,73,81,57,58,66,74,20,99,82,60,18),
	HS = c(65,41,24,61,42,62,19,72,66,42,60,15,11,58,72,65,46,33,20,14,19,71,60,60,60,54,39,16,48,39,62,14,64,33,30,40,57,40,50,11,55,52,38,14,68,50,65,49,54,14,25,68,25,23,43,14,28,74,57,44),
	BS = c(37,41,65,59,48,16,19,20,46,52,35,21,42,48,12,70,71,40,50,67,67,58,19,36,43,68,60,70,33,26,60,52,59,36,56,25,21,54,57,73,25,21,54,61,24,45,44,51,43,59,39,56,55,38,40,21,40,33,45,31),
	e = c(0.24,0.08,0.08,-0.16,-0.07,-0.16,-0.15,-0.05,-0.21,0.24,0.19,-0.3,0.11,-0.37,-0.22,-0.33,0.07,-0.36,-0.01,-0.13,-0.36,-0.15,0.2,0.55,-0.21,-0.09,-0.17,0.19,-0.2,-0.22,-0.01,-0.07,-0.34,-0.01,0.21,0,0.11,0.13,0.02,0.46,0.07,0.06,-0.37,0.41,-0.3,0.22,-0.39,-0.01,-0.19,0.01,0.26,0.14,-0.14,-0.05,0.37,-0.1,-0.02,0.13,-0.1,0)) %>%
	mutate(CA = scale(.3*SDO + .1*HS + .05*BS) %>% round(2) + e) %>%
	select(-e)
```

```{r question_5, exercise=TRUE,exercise.lines = 8}
CA.data

```

```{r question_5-hint-1}
Use the `lm()` function to conduct a linear regression. If you having trouble remembering how to use this function, you can type help(lm) into the console, or google `how to use the lm function in R`.
```

```{r question_5-hint-2}
Remember to use the `summary()` function to get interpretable output for the linear regression.

Next hint will show the solution...
```

```{r question_5-solution}
CA.data

CA.model <- lm(CA ~ SDO + HS + BS,data = CA.data)

CA.summary <- summary(CA.model)
```

```{r question_5-check}
checker()
```

### Question 7

You want to know which predictor from the analysis in Question 6 has the biggest effect; however, the measures of SDO, HS, and BS are on different scales. Therefore, you are required to get standardised coefficients to determine which predictor has the largest effect. For the analysis in Question 6, get the standardised coefficients.

```{r question_6-setup}
CA.data <- data.frame(ID = 1:60,
	SDO = c(96,19,83,92,90,104,54,50,109,89,108,102,109,30,26,100,82,74,70,85,47,84,52,45,53,101,41,68,63,33,32,41,72,39,63,83,69,82,68,112,111,76,63,40,21,23,63,54,73,73,81,57,58,66,74,20,99,82,60,18),
	HS = c(65,41,24,61,42,62,19,72,66,42,60,15,11,58,72,65,46,33,20,14,19,71,60,60,60,54,39,16,48,39,62,14,64,33,30,40,57,40,50,11,55,52,38,14,68,50,65,49,54,14,25,68,25,23,43,14,28,74,57,44),
	BS = c(37,41,65,59,48,16,19,20,46,52,35,21,42,48,12,70,71,40,50,67,67,58,19,36,43,68,60,70,33,26,60,52,59,36,56,25,21,54,57,73,25,21,54,61,24,45,44,51,43,59,39,56,55,38,40,21,40,33,45,31),
	e = c(0.24,0.08,0.08,-0.16,-0.07,-0.16,-0.15,-0.05,-0.21,0.24,0.19,-0.3,0.11,-0.37,-0.22,-0.33,0.07,-0.36,-0.01,-0.13,-0.36,-0.15,0.2,0.55,-0.21,-0.09,-0.17,0.19,-0.2,-0.22,-0.01,-0.07,-0.34,-0.01,0.21,0,0.11,0.13,0.02,0.46,0.07,0.06,-0.37,0.41,-0.3,0.22,-0.39,-0.01,-0.19,0.01,0.26,0.14,-0.14,-0.05,0.37,-0.1,-0.02,0.13,-0.1,0)) %>%
	mutate(CA = scale(.3*SDO + .1*HS + .05*BS) %>% round(2) + e) %>%
	select(-e)
```

```{r question_6, exercise=TRUE,exercise.lines = 8}
#CA.data

```

```{r question_6-hint-1}
You could manually compute standardised variables and enter them into a regression...
```

```{r question_6-hint-2}
The `lm.beta()` function takes the output of a linear regression from the `lm()` output.

Next hint will show the solution...
```

```{r question_6-solution}
#Manually calculating standardised variables:
summarise(CA.data,
          CA.mean = mean(CA), CA.sd = sd(CA),
          SDO.mean = mean(SDO), SDO.sd = sd(SDO),
          HS.mean = mean(HS), HS.sd = sd(HS),
          BS.mean = mean(BS), BS.sd = sd(BS))

zCA.data <- mutate(CA.data,
                   z.CA = (CA - -0.02416667)/1.040271,
                   z.SDO = (SDO - 67.2)/26.4529,
                   z.HS = (HS - 43.58333)/19.33846,
                   z.BS = (BS - 44.28333)/16.30337)

##Numbers above are taken from the `summarise()` output.

CA.model <- lm(z.CA ~ z.SDO + z.HS + z.BS,data = zCA.data)

CA.summary <- summary(CA.model)

#Using `lm.beta()` function:
CA.model <- lm(CA ~ SDO + HS + BS,data = CA.data)

lm.beta(CA.model)
```

```{r question_6-quiz}
quiz(question("Which predictor has the largest effect on women's likelihood of engaging in Collective Action?",
        answer("Social Dominance Orientation",correct = TRUE),
        answer("Hostile Sexism"),
        answer("Benevolent Sexism"),
        answer("None of the above"),allow_retry = TRUE))
```

### Question 8

Using ggplot functions, create a scatterplot with a line-of-best-fit from the data from Question 5 and 6 between Social Dominance Orientation and likelihood of engaging in Collective Action. Save the plot as `CA.plot`.

```{r question_7-setup}
CA.data <- data.frame(ID = 1:60,
	SDO = c(96,19,83,92,90,104,54,50,109,89,108,102,109,30,26,100,82,74,70,85,47,84,52,45,53,101,41,68,63,33,32,41,72,39,63,83,69,82,68,112,111,76,63,40,21,23,63,54,73,73,81,57,58,66,74,20,99,82,60,18),
	HS = c(65,41,24,61,42,62,19,72,66,42,60,15,11,58,72,65,46,33,20,14,19,71,60,60,60,54,39,16,48,39,62,14,64,33,30,40,57,40,50,11,55,52,38,14,68,50,65,49,54,14,25,68,25,23,43,14,28,74,57,44),
	BS = c(37,41,65,59,48,16,19,20,46,52,35,21,42,48,12,70,71,40,50,67,67,58,19,36,43,68,60,70,33,26,60,52,59,36,56,25,21,54,57,73,25,21,54,61,24,45,44,51,43,59,39,56,55,38,40,21,40,33,45,31),
	e = c(0.24,0.08,0.08,-0.16,-0.07,-0.16,-0.15,-0.05,-0.21,0.24,0.19,-0.3,0.11,-0.37,-0.22,-0.33,0.07,-0.36,-0.01,-0.13,-0.36,-0.15,0.2,0.55,-0.21,-0.09,-0.17,0.19,-0.2,-0.22,-0.01,-0.07,-0.34,-0.01,0.21,0,0.11,0.13,0.02,0.46,0.07,0.06,-0.37,0.41,-0.3,0.22,-0.39,-0.01,-0.19,0.01,0.26,0.14,-0.14,-0.05,0.37,-0.1,-0.02,0.13,-0.1,0)) %>%
	mutate(CA = scale(.3*SDO + .1*HS + .05*BS) %>% round(2) + e) %>%
	select(-e)
```

```{r question_7, exercise=TRUE,exercise.lines = 8}
#CA.data

CA.plot <- 
```

```{r question_7-hint-1}
Use geom_point() to create the scatterplot. If you can't remember how to make a graph using ggplot, review material from two weeks ago's workbooks/exercises.

```

```{r question_7-hint-2}
Use geom_smooth() to create a line-of-best-fit. You will need to include the following argument: method = "lm".

Next hint will show the solution...
```

```{r question_7-solution}
CA.plot <- ggplot(data = CA.data,aes(x = SDO,y = CA)) +
  geom_point() +
  geom_smooth(method = "lm")

CA.plot
```

### Question 9

You conducted a study investigating whether priming participants with words about childhood increases the speed of recollection of childhood memory. Participants were assigned to either a prime or no prime condition (coded as -.5 and .5 respectively) before being asked to recall a childhood memory, with recall time being recorded. Run an standardised linear regression using the `lm.beta()` function to determine whether recall time is associated with the priming condition, while controlling for participant's age. The data.frame for this question is called `memory.data`, save the output of the unstandardised linear regression as `memory.summary`, and save the output from the `lm.beta()` function as `memory.beta`.

```{r question_8-setup}
memory.data <- data.frame(ID = 1:34,
	age = c(26,30,22,23,29,32,25,26,21,18,27,26,31,27,25,25,18,32,18,27,22,32,18,29,34,31,30,22,34,22,18,21,34,21),
	condition = c(0.5,0.5,-0.5,-0.5,0.5,-0.5,-0.5,-0.5,-0.5,-0.5,-0.5,0.5,0.5,0.5,0.5,0.5,0.5,-0.5,-0.5,-0.5,-0.5,0.5,-0.5,-0.5,-0.5,0.5,-0.5,-0.5,-0.5,0.5,0.5,0.5,-0.5,-0.5),
	e = c(782.6,343.5,204.2,1263.4,284.8,1032.8,-143.9,410.9,506.9,-100,162.7,1066.1,-166.1,737.8,847.6,464.8,1197.5,550.9,968.6,535.4,675,1484.1,224.4,1259.6,-96.9,750.1,502.6,913.4,186.3,315.3,669.8,598.6,765.2,324.9)) %>%
	mutate(recall = abs(e) + 10*(age-25.76) + .2*condition) %>%
	select(-e)
```

```{r question_8, exercise=TRUE,exercise.lines = 8}
#memory.data

```

```{r question_8-hint-1}
Dichotomous variables (i.e., have two variables) can be entered into a standard linear regression if it has been effect coded (one value is coded as -.5, while another value is coded as .5).
```

```{r question_8-hint-2}
Entering predictors into a regression will give you the unique association between the predictor and the outcome. Therefore, including a variable as a predictor is one way of controlling for it's effect when assessing the association between two other variables...

Next hint will show the solution...
```

```{r question_8-solution}
memory.lm <- lm(recall ~ condition + age,data = memory.data)

memory.summary <- summary(memory.lm)

memory.beta <- lm.beta(memory.lm)
```

```{r question_8-check}
checker()
```

## Advanced Exercises


